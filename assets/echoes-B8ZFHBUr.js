var Ns=Object.defineProperty;var Os=(S,s,t)=>s in S?Ns(S,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[s]=t;var i=(S,s,t)=>Os(S,typeof s!="symbol"?s+"":s,t);import{h as d,f as L,D as u,m as Bs,t as E}from"./utils-Car4rOKU.js";import{R as k,b as W,B as n,S as l,c as M,u as F,a as g,d as Rs,g as $,e as C,f as o,h,A as R}from"./echo-DrfiN13P.js";import{o as p,R as ws,n as B,a as c,u as ss,S as x,p as vs,W as ys,c as Ts,q as es}from"./resonator-Br2B72CS.js";import{a_ as Y,ai as xs}from"./index-qc7TtUQv.js";import{A as O}from"./affix-NmzP8Gk5.js";import"./sonata-BIM856lI.js";class v{constructor(s={}){i(this,"id","");i(this,"type","");i(this,"level","");i(this,"base_attr","");i(this,"bonus_types",[]);i(this,"elment_zh_tw","");i(this,"dmg","");i(this,"hit","1");!s||Object.keys(s).length===0||Object.assign(this,s)}duplicate(){const s=new v;return s.id=this.id,s.type=this.type,s.level=this.level,s.base_attr=this.base_attr,s.bonus_types=this.bonus_types,s.elment_zh_tw=this.elment_zh_tw,s.dmg=this.dmg,s}getBonusTypesString(){return this.bonus_types.join(", ")}}class U{constructor(s={}){i(this,"id","");i(this,"no","");i(this,"name","");i(this,"element_en","");i(this,"element_zh_tw","");i(this,"level","90");i(this,"chain","0");i(this,"hp","");i(this,"atk","");i(this,"def","");i(this,"energy_regen","100.00%");i(this,"normal_attack_lv","10");i(this,"resonance_skill_lv","10");i(this,"forte_circuit_lv","10");i(this,"resonance_liberation_lv","10");i(this,"intro_skill_lv","10");i(this,"inherent_skill_1",!0);i(this,"inherent_skill_2",!0);i(this,"stat_bonus",new p);i(this,"skill",new v);i(this,"_skill_item",{title:"",value:void 0});i(this,"_info");if(!s||Object.keys(s).length===0)return;const{stat_bonus:t,skill:e,_skill_item:a,_info:_,...r}=s;Object.assign(this,r),this.stat_bonus=new p(t),this.skill=new v(e),s._skill_item.title&&(this._skill_item.title=s._skill_item.title),s._skill_item.value&&(this._skill_item.value=new v(s._skill_item.value)),this._info=new ws(_)}duplicate(){const s=new U;return s.id=this.id,s.no=this.no,s.name=this.name,s.element_zh_tw=this.element_zh_tw,s.level=this.level,s.chain=this.chain,s.hp=this.hp,s.atk=this.atk,s.def=this.def,s.energy_regen=this.energy_regen,s.normal_attack_lv=this.normal_attack_lv,s.resonance_skill_lv=this.resonance_skill_lv,s.forte_circuit_lv=this.forte_circuit_lv,s.resonance_liberation_lv=this.resonance_liberation_lv,s.intro_skill_lv=this.intro_skill_lv,s.inherent_skill_1=this.inherent_skill_1,s.inherent_skill_2=this.inherent_skill_2,s.stat_bonus=this.stat_bonus.duplicate(),s.skill=this.skill.duplicate(),s._skill_item={title:this._skill_item.title,value:void 0},this._skill_item.value!==void 0&&(s._skill_item.value=this._skill_item.value.duplicate()),this._info!==void 0&&(s._info=this._info.duplicate()),s}getId(){return`+${this.chain}${this.name}`}getJson(){return JSON.parse(JSON.stringify(this))}getBaseAttrs(){const s=[],t=new B;t.stack="1";let e,a=this.skill.base_attr;switch(this.skill.base_attr){case c.HP:e=d(this.hp).toString();break;case c.DEF:e=d(this.def).toString();break;case c.ATK:default:e=d(this.atk).toString(),a=c.ATK;break}return this.name&&(a=`${this.name}-${a}`),t.category=k.ATTR,t.source=a,t.value=e,t.type=W.ATTR,t.updateId(),s.push(t),s}getRowBuffs(){return this.stat_bonus.getRowBuffs(this.name)}getSkillRowBuffs(){const s=[],t=new B;t.category=k.RESONATOR,t.type=n.SKILL_DMG_ADDITION,t.value=d(this.skill.dmg).toString(),t.stack="1";let e="";return this.name&&(e=this.name),this.skill.type&&(e=`${e}-${this.skill.type}`),this.skill.id&&(e=`${e}-${this.skill.id}`),t.source=e,t.updateId(),t.value&&s.push(t),s}async updateByLevel(s=""){var t;if(s?this.level=s:s=this.level,!!s&&this.name){if(!((t=this._info)!=null&&t.attrs.length)){const a=await ss().getInfoByName(this.name);this._info=a}this.hp=this._info.getHp(s),this.atk=this._info.getAtk(s),this.def=this._info.getDef(s)}}async updateByName(){const s=ss();this.stat_bonus=new p,this.skill=new v,this._skill_item={title:"",value:void 0};const t=this.name,e=s.getNoByName(t);if(!e)return;this.no=e;const a=await s.getInfoByName(t);this._info=a,this.element_en=a.element_en,this.element_zh_tw=a.element_zh_tw,this.updateByLevel();const _=a.stat_bonus;Object.keys(_).forEach(r=>{const b=_[r];this.stat_bonus[r]=b})}updateSkillDmg(s){if(s.dmg){this.skill.dmg=s.dmg;return}const t=this.skill.type;let e;switch(t){case x.NORMAL_ATTACK:e=this.normal_attack_lv;break;case x.RESONANCE_SKILL:e=this.resonance_skill_lv;break;case x.FORTE_CIRCUIT:e=this.forte_circuit_lv;break;case x.RESONANCE_LIBERATION:e=this.resonance_liberation_lv;break;case x.INTRO_SKILL:e=this.intro_skill_lv;break;default:e="10"}this.skill.level=e,this.skill.dmg=s[`lv${e}`]}updateSkill(s=void 0){if(!s){if(!this._skill_item)return;s=this._skill_item.value}s&&(this.skill=new v,this.skill.id=s.id,this.skill.type=s.skill_type,this.skill.base_attr=s.base_attr,s.element&&(this.skill.elment_zh_tw=s.element,this.skill.bonus_types.push(s.element)),s.bonus_type&&this.skill.bonus_types.push(s.bonus_type),s.coordinated&&this.skill.bonus_types.push(l.COORDINATED_ATTACK),this.updateSkillDmg(s))}updateSkillById(s){var e;let t=(e=this._info)==null?void 0:e.getDamageSkillItemById(s);t||(t=vs(s)),t&&this.updateSkill(t.value)}}class P{constructor(s={}){i(this,"no","");i(this,"name","");i(this,"star","");i(this,"type","");i(this,"level","90");i(this,"tune","1");i(this,"atk","");i(this,"stat_bonus",new p);i(this,"passive_stat_bonus",new p);i(this,"_info");if(!s||Object.keys(s).length===0)return;const{stat_bonus:t,passive_stat_bonus:e,_info:a,..._}=s;Object.assign(this,_),this.stat_bonus=new p(t),this.passive_stat_bonus=new p(e),this._info=new ys(a)}duplicate(){const s=new P;return s.no=this.no,s.name=this.name,s.star=this.star,s.type=this.type,s.level=this.level,s.tune=this.tune,s.atk=this.atk,s.stat_bonus=this.stat_bonus.duplicate(),s.passive_stat_bonus=this.passive_stat_bonus.duplicate(),this._info!==void 0&&(s._info=this._info.duplicate()),s}getId(){return`+${this.tune}${this.name}`}getJson(){return JSON.parse(JSON.stringify(this))}getBaseAttrs(){const s=[],t=new B;let e=c.ATK;return this.name&&(e=`${this.name}-${e}`),t.source=e,t.category=k.ATTR,t.value=this.atk,t.stack="1",t.type=W.ATTR,t.updateId(),t.value&&s.push(t),s}getRowBuffs(){let s="";this.name&&(s=this.name),this.tune&&(s=`${s}-${this.tune}${M.TUNE}`);let t=`${s}-${M.PASSIVE}`;const e=this.passive_stat_bonus.getRowBuffs(t);return[...this.stat_bonus.getRowBuffs(s),...e]}getMaxLevel(){return this._info?this._info.getMaxLevel():"90"}getLevels(){const s=new Array("1","20","20+","40","40+","50","50+","60","60+","70","70+","80","80+","90"),t=[],e=d(this.getMaxLevel());s.forEach(_=>{d(_)<=e&&t.push(_)});const a=t.at(-1);return a&&a.includes("+")&&t.pop(),t}updateRowWeaponByName(){const s=this.name;if(!s)return;const t=Ts();this.stat_bonus=new p,this.passive_stat_bonus=new p;const e=t.getNoByName(s);if(this.no=e,!this.no)return;const a=t.getInfoByNo(e);if(!a)return;this._info=a,this.star=a.star,this.type=a.type;const _=a.getMaxLevel(),r=d(this.level),b=d(_);r>b?this.level=_:r===b&&this.level.includes("+")&&(this.level=_);const N=this.level;if(N){this.atk=a.getAtk(N);const A=a.getStatBonus(N);Object.keys(A).forEach(I=>{const w=A[I];this.stat_bonus[I]=d(w).toString()})}if(this.tune){const A=a.getPassiveStatBonus(this.tune);Object.keys(A).forEach(I=>{const w=A[I];this.passive_stat_bonus[I]=d(w).toString()})}}}const m={ABYSSAL_PATRICIUS:"毒冠貴族",VITREUM_DANCER:"琉璃刀伶",LORELEI:"羅蕾萊",SENTRY_CONSTRUCT:"異構武裝",DRAGON_OF_DIRGE:"嘆息古龍",HECATE:"赫卡忒",NIGHTMARE_FEILIAN_BERINGAL:"夢魘·飛廉之猩",NIGHTMARE_IMPERMANENCE_HERON:"夢魘·無常凶鷺",NIGHTMARE_THUNDERING_MEPHIS:"夢魘·雲閃之鱗",NIGHTMARE_TEMPEST_MEPHIS:"夢魘·朔雷之鱗",NIGHTMARE_CROWNLESS:"夢魘·無冠者",NIGHTMARE_INFERNO_RIDER:"夢魘·燎照之騎",NIGHTMARE_MOURNING_AIX:"夢魘·哀聲鷙",CAPITANEUS:"榮光節使",NIGHTMARE_LAMPYLUMEN_MYRIAD:"夢魘·輝螢軍勢",REMINISCENCE_FLEURDELYS:"共鳴迴響·芙露德莉斯",KERASAUR:"角鱷",NIGHTMARE_KELPIE:"夢魘·凱爾匹",LIONESS_OF_GLORY:"榮耀獅像",NIGHTMARE_HECATE:"夢魘·赫卡忒",REMINISCENCE_FENRICO:"共鳴迴響·芬萊克",CORROSAURUS:"蝕脊龍",THE_FALSE_SOVEREIGN:"偽作的神王",LADY_OF_THE_SEA:"海之女"},f={FREEZING_FROST:"凝夜白霜",MOLTEN_RIFT:"熔山裂谷",VOID_THUNDER:"徹空冥雷",SIERRA_GALE:"嘯谷長風",CELESTIAL_LIGHT:"浮星祛暗",SUN_SINKING_ECLIPSE:"沉日劫明",REJUVENATING_GLOW:"隱世回光",MOONLIT_CLOUDS:"輕雲出月",LINGERING_TUNES:"不絕餘音",FROSTY_RESOLVE:"凌冽決斷之心",ETERNAL_RADIANCE:"此間永駐之光",MIDNIGHT_VEIL:"幽夜隱匿之帷",EMPYREAN_ANTHEM:"高天共奏之曲",TIDEBREAKING_COURAGE:"無懼浪濤之勇"};class H{constructor(s={}){i(this,"no","");i(this,"name","");i(this,"sonata","");i(this,"cost","");i(this,"abbr","");i(this,"main_affix",new p);i(this,"sub_affix",new p);i(this,"_fixed_main_affix_key","");i(this,"_main_affix_item",{title:"",value:void 0});i(this,"_main_affix_items",[]);i(this,"_item",{title:"",value:void 0});i(this,"_sonatas",this.getSonataNames());if(!s||Object.keys(s).length===0)return;const{main_affix:t,sub_affix:e,...a}=s;Object.assign(this,a),this.main_affix=new p(t),this.sub_affix=new p(e)}duplicate(){const s=new H;return s.no=this.no,s.name=this.name,s.sonata=this.sonata,s.main_affix=this.main_affix.duplicate(),s.sub_affix=this.sub_affix.duplicate(),s._fixed_main_affix_key=this._fixed_main_affix_key,s._main_affix_item=JSON.parse(JSON.stringify(this._main_affix_item)),s._main_affix_items=JSON.parse(JSON.stringify(this._main_affix_items)),s._item=JSON.parse(JSON.stringify(this._item)),s._sonatas=JSON.parse(JSON.stringify(this._sonatas)),s}reset(){this.cost="",this._item={title:"",value:void 0},this.resetMainAffix(),this.resetSubAffix()}resetMainAffix(){this.main_affix=new p,this._fixed_main_affix_key="",this._main_affix_item={title:"",value:void 0}}resetSubAffix(){this.sub_affix=new p}getId(){return`${this.cost}${this.abbr}`}getCosts(){return F().getCosts()}getEchoItems(){return F().getEchoItemsForCalculation()}getSonataNames(){return F().getSonataNames()}getSubAffixKeys(){return F().getSubAffixKeys()}updateByCost(s){if(!s)return;switch(this.cost=s,this.updateMainAffixKeysByCost(),this.resetMainAffix(),this.cost){case"4":case"3":this._fixed_main_affix_key=g.ATK;break;case"1":this._fixed_main_affix_key=g.HP;break}const t=Rs(this.cost);this.main_affix[this._fixed_main_affix_key]=t[this._fixed_main_affix_key],this._main_affix_item={title:"",value:void 0}}updateByEchoItem(s){(!s||!s.title||!s.value)&&(s=this._item),!(!s||!s.title||!s.value)&&(this.name=s.value.name,s.value.sonatas&&s.value.sonatas.length>0?this._sonatas=s.value.sonatas:this._sonatas=this.getSonataNames(),this.sonata="",this._sonatas.length===1&&(this.sonata=this._sonatas[0]),this._item=s,this.updateByCost(s.value.cost))}updateMainAffix(s){const t=this.cost;if(!s||!t)return;this._main_affix_item={title:$(s),value:s};const e=C(t);this.main_affix[s]=e[s]}updateMainAffixKeysByCost(){const s=this.cost;if(!s)return;const t=C(s);this._main_affix_items=Object.keys(t).map((e,a,_)=>({title:$(e),value:e}))}}class K{constructor(s={}){i(this,"name1","");i(this,"sonatas",[]);i(this,"total_cost",0);i(this,"main_affix",new p);i(this,"sub_affix",new p);i(this,"stat_bonus",new p);if(!s||Object.keys(s).length===0)return;const{main_affix:t,sub_affix:e,...a}=s;Object.assign(this,a),this.main_affix=new p(t),this.sub_affix=new p(e)}duplicate(){const s=new K;return s.name1=this.name1,s.sonatas=JSON.parse(JSON.stringify(this.sonatas)),s.total_cost=this.total_cost,s.main_affix=this.main_affix.duplicate(),s.sub_affix=this.sub_affix.duplicate(),s}getRowBuffs(){const s=this.main_affix.getRowBuffs(`${k.ECHO}-${M.MAIN_AFFIX}`),t=this.sub_affix.getRowBuffs(`${k.ECHO}-${M.SUB_AFFIX}`);return[...s,...t]}getStat(s){return L(this.main_affix[s]).plus(L(this.sub_affix[s])).plus(L(this.stat_bonus[s])).toString()}}class G{constructor(s={}){i(this,"resonator_name","");i(this,"policy","");i(this,"base_attr","");i(this,"main_skill_bonus","");i(this,"echoes",[]);i(this,"summary",new K);if(!s||Object.keys(s).length===0){this.echoes=Array.from({length:5},(_,r)=>new H);return}const{echoes:t,summary:e,...a}=s;Object.assign(this,a),this.echoes=[],t.forEach(_=>{this.echoes.push(new H(_))}),this.summary=new K(e)}duplicate(){const s=new G;return s.resonator_name=this.resonator_name,s.policy=this.policy,s.base_attr=this.base_attr,this.echoes.forEach((t,e)=>{s.echoes[e]=t.duplicate()}),s.summary=this.summary.duplicate(),s}getId(){let s="";return this.echoes.forEach(t=>{s=`${s}${t.getId()}`}),s}getJson(){return JSON.parse(JSON.stringify(this))}getRowBuffs(){return this.summary.getRowBuffs()}getPassiveSkillRowBuff(s,t,e,a,_){const r=new B;return r.category=k.ECHO,r.source=s,r.type=t,r.value=_,r.stack="1",r.element=e,r.skill_bonus_type=a,r.updateId(),r}getPassiveSkillRowBuffs(){const s=[],t=this.summary.name1;if(!t)return s;const e=`${t}-${M.MAIN_SLOT}`;switch(t){case m.ABYSSAL_PATRICIUS:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.GLACIO,"","0.12"));break;case m.VITREUM_DANCER:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.ELECTRO,"","0.12"));break;case m.LORELEI:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.HAVOC,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.BASIC,"0.12"));break;case m.SENTRY_CONSTRUCT:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.GLACIO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.SKILL,"0.12"));break;case m.DRAGON_OF_DIRGE:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.FUSION,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.BASIC,"0.12"));break;case m.HECATE:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.COORDINATED_ATTACK,"0.4"));break;case m.NIGHTMARE_FEILIAN_BERINGAL:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.AERO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.HEAVY,"0.12"));break;case m.NIGHTMARE_IMPERMANENCE_HERON:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.HAVOC,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.HEAVY,"0.12"));break;case m.NIGHTMARE_THUNDERING_MEPHIS:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.ELECTRO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.LIBERATION,"0.12"));break;case m.NIGHTMARE_TEMPEST_MEPHIS:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.ELECTRO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.SKILL,"0.12"));break;case m.NIGHTMARE_CROWNLESS:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.HAVOC,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.BASIC,"0.12"));break;case m.NIGHTMARE_INFERNO_RIDER:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.FUSION,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.SKILL,"0.12"));break;case m.NIGHTMARE_MOURNING_AIX:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.SPECTRO,"","0.12"));break;case m.CAPITANEUS:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.SPECTRO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.HEAVY,"0.12"));break;case m.NIGHTMARE_LAMPYLUMEN_MYRIAD:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.GLACIO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.COORDINATED_ATTACK,"0.3"));break;case m.REMINISCENCE_FLEURDELYS:switch(this.resonator_name){case es.RESONATOR_AERO:case es.CARTETHYIA:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.AERO,"","0.1"));break}s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.AERO,"","0.1"));break;case m.KERASAUR:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.AERO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.LIBERATION,"0.12"));break;case m.NIGHTMARE_KELPIE:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.GLACIO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.AERO,"","0.12"));break;case m.LIONESS_OF_GLORY:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.FUSION,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.LIBERATION,"0.12"));break;case m.NIGHTMARE_HECATE:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.HAVOC,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.ECHO,"0.2"));break;case m.REMINISCENCE_FENRICO:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.AERO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.HEAVY,"0.12"));break;case m.CORROSAURUS:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.FUSION,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.ECHO,"0.2"));break;case m.THE_FALSE_SOVEREIGN:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.ELECTRO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.HEAVY,"0.12"));break;case m.LADY_OF_THE_SEA:s.push(this.getPassiveSkillRowBuff(e,n.BONUS,o.AERO,"","0.12")),s.push(this.getPassiveSkillRowBuff(e,n.BONUS,"",l.LIBERATION,"0.12"));break;default:return s}return s}getSonatas(){if(this.summary.sonatas.length>0)return this.summary.sonatas;const s=[];return this.echoes.forEach(t=>{s.push(t.sonata)}),s}getSonataRowBuff(s,t,e,a,_){const r=new B;return r.category=k.SONATA,r.source=`${s}-2/2`,r.type=t,r.value=_,r.stack="1",r.element=e,r.skill_bonus_type=a,r.updateId(),r}getSonataRowBuffs(){const s=[],t={[f.FREEZING_FROST]:0,[f.MOLTEN_RIFT]:0,[f.VOID_THUNDER]:0,[f.SIERRA_GALE]:0,[f.CELESTIAL_LIGHT]:0,[f.SUN_SINKING_ECLIPSE]:0,[f.REJUVENATING_GLOW]:0,[f.MOONLIT_CLOUDS]:0,[f.LINGERING_TUNES]:0,[f.FROSTY_RESOLVE]:0,[f.ETERNAL_RADIANCE]:0,[f.MIDNIGHT_VEIL]:0,[f.EMPYREAN_ANTHEM]:0,[f.TIDEBREAKING_COURAGE]:0};if(this.echoes.forEach(e=>{const a=e.sonata;a&&(t[a]+=1)}),t[f.FREEZING_FROST]>=2){const e=this.getSonataRowBuff(f.FREEZING_FROST,n.BONUS,o.GLACIO,"","0.1");s.push(e)}if(t[f.MOLTEN_RIFT]>=2){const e=this.getSonataRowBuff(f.MOLTEN_RIFT,n.BONUS,o.FUSION,"","0.1");s.push(e)}if(t[f.VOID_THUNDER]>=2){const e=this.getSonataRowBuff(f.VOID_THUNDER,n.BONUS,o.ELECTRO,"","0.1");s.push(e)}if(t[f.SIERRA_GALE]>=2){const e=this.getSonataRowBuff(f.SIERRA_GALE,n.BONUS,o.AERO,"","0.1");s.push(e)}if(t[f.CELESTIAL_LIGHT]>=2){const e=this.getSonataRowBuff(f.CELESTIAL_LIGHT,n.BONUS,o.SPECTRO,"","0.1");s.push(e)}if(t[f.SUN_SINKING_ECLIPSE]>=2){const e=this.getSonataRowBuff(f.SUN_SINKING_ECLIPSE,n.BONUS,o.HAVOC,"","0.1");s.push(e)}if(t[f.REJUVENATING_GLOW]>=2){const e=this.getSonataRowBuff(f.REJUVENATING_GLOW,n.BONUS,"",l.HEALING,"0.1");s.push(e)}if(t[f.MOONLIT_CLOUDS]>=2){const e=this.getSonataRowBuff(f.MOONLIT_CLOUDS,n.ENERGY_REGEN,"","","0.1");s.push(e)}if(t[f.LINGERING_TUNES]>=2){const e=this.getSonataRowBuff(f.LINGERING_TUNES,n.ATK_P,"","","0.1");s.push(e)}if(t[f.FROSTY_RESOLVE]>=2){const e=this.getSonataRowBuff(f.FROSTY_RESOLVE,n.BONUS,"",l.SKILL,"0.12");s.push(e)}if(t[f.ETERNAL_RADIANCE]>=2){const e=this.getSonataRowBuff(f.ETERNAL_RADIANCE,n.BONUS,o.SPECTRO,"","0.1");s.push(e)}if(t[f.MIDNIGHT_VEIL]>=2){const e=this.getSonataRowBuff(f.MIDNIGHT_VEIL,n.BONUS,o.HAVOC,"","0.1");s.push(e)}if(t[f.EMPYREAN_ANTHEM]>=2){const e=this.getSonataRowBuff(f.EMPYREAN_ANTHEM,n.ENERGY_REGEN,"","","0.1");s.push(e)}if(t[f.TIDEBREAKING_COURAGE]>=2){const e=this.getSonataRowBuff(f.TIDEBREAKING_COURAGE,n.ENERGY_REGEN,"","","0.1");s.push(e)}return s}getEchoPolicyItems(){return[{title:Y.global.t(`general.${O.AFFIXES_15_1}`),value:O.AFFIXES_15_1},{title:Y.global.t(`general.${O.AFFIXES_20_SMALL}`),value:O.AFFIXES_20_SMALL},{title:Y.global.t(`general.${O.AFFIXES_20_SKILL_BONUS}`),value:O.AFFIXES_20_SKILL_BONUS}]}resetPolicy(){this.policy=""}resetSummary(){this.summary.name1="",this.summary.sonatas=[],this.summary.total_cost=0,this.summary.main_affix=new p,this.summary.sub_affix=new p,this.summary.stat_bonus=new p}getEcho(s){return this.echoes[s]}updateEchoByCost(s,t){this.resetPolicy(),this.getEcho(s).updateByCost(t)}updateEchoByEchoItem(s,t){this.resetPolicy(),this.getEcho(s).updateByEchoItem(t)}updateEchoMainAffix(s,t){this.resetPolicy(),this.getEcho(s).updateMainAffix(t)}updateSummaryByEchoes(){this.resetSummary();const s=this.echoes[0].name;s&&(this.summary.name1=s),this.echoes.forEach(e=>{this.summary.total_cost+=parseFloat(e.cost);const a=e.sonata;a&&this.summary.sonatas.push(a),this.summary.main_affix.addStatBuff(e.main_affix),this.summary.sub_affix.addStatBuff(e.sub_affix)}),[...this.getPassiveSkillRowBuffs(),...this.getSonataRowBuffs()].forEach(e=>{const a=e.type,_=L(e.stack).times(L(e.value));let r;switch(a){case n.BONUS:switch(e.element){case o.GLACIO:r=g.BONUS_GLACIO;break;case o.FUSION:r=g.BONUS_FUSION;break;case o.ELECTRO:r=g.BONUS_ELECTRO;break;case o.AERO:r=g.BONUS_AERO;break;case o.SPECTRO:r=g.BONUS_SPECTRO;break;case o.HAVOC:r=g.BONUS_HAVOC;break}switch(e.skill_bonus_type){case l.BASIC:r=g.BONUS_BASIC_ATTACK;break;case l.HEAVY:r=g.BONUS_HEAVY_ATTACK;break;case l.SKILL:r=g.BONUS_RESONANCE_SKILL;break;case l.LIBERATION:r=g.BONUS_RESONANCE_LIBERATION;break;case l.HEALING:r=g.BONUS_HEALING;break}break;case n.ENERGY_REGEN:r=g.ENERGY_REGEN;break}r&&this.summary.stat_bonus.addByKey(r,_)})}}var as,ns,rs,os,_s,fs,us,ls,hs,cs,ms,ps,Es,ds;ds=h.SKILL_DMG_ADDITION,Es=h.MAGNIFIER,ps=h.AMPLIFIER,ms=h.BONUS,cs=h.HP_P,hs=h.HP,ls=h.ATK_P,us=h.ATK,fs=h.DEF_P,_s=h.DEF,os=h.CRIT_RATE,rs=h.CRIT_DMG,ns=h.IGNORE_DEF,as=h.REDUCE_RES;class ts{constructor(s={}){i(this,ds,"");i(this,Es,"");i(this,ps,"");i(this,ms,"");i(this,cs,"");i(this,hs,"");i(this,ls,"");i(this,us,"");i(this,fs,"");i(this,_s,"");i(this,os,"");i(this,rs,"");i(this,ns,"");i(this,as,"");!s||Object.keys(s).length===0||Object.assign(this,s)}reset(){this[h.SKILL_DMG_ADDITION]="",this[h.MAGNIFIER]="",this[h.AMPLIFIER]="",this[h.BONUS]="",this[h.HP_P]="",this[h.HP]="",this[h.ATK_P]="",this[h.ATK]="",this[h.DEF_P]="",this[h.DEF]="",this[h.CRIT_RATE]="",this[h.CRIT_DMG]="",this[h.IGNORE_DEF]="",this[h.REDUCE_RES]=""}getKeys(){const s=[];return Object.values(h).forEach(t=>{const e=this[t];d(e)>0&&s.push(t)}),s}getRowBuffs(){const s=[];return this.getKeys().forEach(e=>{const a=n[e.toUpperCase()],_=d(this[e]).toString(),r=new B;r.category=k.MANUAL,r.source=k.MANUAL,r.type=a,r.value=_,r.stack="1",r.updateId(),s.push(r)}),s}}class J{constructor(s={}){i(this,"buffs",[]);i(this,"manual",new ts);if(!s||Object.keys(s).length===0)return;const{manual:t,...e}=s;Object.assign(this,e),this.manual=new ts(t)}getJson(){return JSON.parse(JSON.stringify(this))}getRowBuffs(){return[...this.buffs,...this.manual.getRowBuffs()]}}const Ls=[{name:"90等抗性10白板",level:"90",def:"1512",res_physics:"10.00%",res_glacio:"10.00%",res_fusion:"10.00%",res_electro:"10.00%",res_aero:"10.00%",res_spectro:"10.00%",res_havoc:"10.00%"},{name:"90等抗性20白板",level:"90",def:"1512",res_physics:"20.00%",res_glacio:"20.00%",res_fusion:"20.00%",res_electro:"20.00%",res_aero:"20.00%",res_spectro:"20.00%",res_havoc:"20.00%"},{name:"90等抗性30白板",level:"90",def:"1512",res_physics:"30.00%",res_glacio:"30.00%",res_fusion:"30.00%",res_electro:"30.00%",res_aero:"30.00%",res_spectro:"30.00%",res_havoc:"30.00%"},{name:"90等抗性40白板",level:"90",def:"1512",res_physics:"40.00%",res_glacio:"40.00%",res_fusion:"40.00%",res_electro:"40.00%",res_aero:"40.00%",res_spectro:"40.00%",res_havoc:"40.00%"},{name:"90等抗性50白板",level:"90",def:"1512",res_physics:"50.00%",res_glacio:"50.00%",res_fusion:"50.00%",res_electro:"50.00%",res_aero:"50.00%",res_spectro:"50.00%",res_havoc:"50.00%"},{name:"90等抗性60白板",level:"90",def:"1512",res_physics:"60.00%",res_glacio:"60.00%",res_fusion:"60.00%",res_electro:"60.00%",res_aero:"60.00%",res_spectro:"60.00%",res_havoc:"60.00%"},{name:"90等抗性70白板",level:"90",def:"1512",res_physics:"70.00%",res_glacio:"70.00%",res_fusion:"70.00%",res_electro:"70.00%",res_aero:"70.00%",res_spectro:"70.00%",res_havoc:"70.00%"},{name:"90等抗性80白板",level:"90",def:"1512",res_physics:"80.00%",res_glacio:"80.00%",res_fusion:"80.00%",res_electro:"80.00%",res_aero:"80.00%",res_spectro:"80.00%",res_havoc:"80.00%"},{name:"100等抗性10白板",level:"100",def:"1592",res_physics:"10.00%",res_glacio:"10.00%",res_fusion:"10.00%",res_electro:"10.00%",res_aero:"10.00%",res_spectro:"10.00%",res_havoc:"10.00%"},{name:"100等抗性20白板",level:"100",def:"1592",res_physics:"20.00%",res_glacio:"20.00%",res_fusion:"20.00%",res_electro:"20.00%",res_aero:"20.00%",res_spectro:"20.00%",res_havoc:"20.00%"},{name:"100等抗性30白板",level:"100",def:"1592",res_physics:"30.00%",res_glacio:"30.00%",res_fusion:"30.00%",res_electro:"30.00%",res_aero:"30.00%",res_spectro:"30.00%",res_havoc:"30.00%"},{name:"100等抗性40白板",level:"100",def:"1592",res_physics:"40.00%",res_glacio:"40.00%",res_fusion:"40.00%",res_electro:"40.00%",res_aero:"40.00%",res_spectro:"40.00%",res_havoc:"40.00%"},{name:"100等抗性50白板",level:"100",def:"1592",res_physics:"50.00%",res_glacio:"50.00%",res_fusion:"50.00%",res_electro:"50.00%",res_aero:"50.00%",res_spectro:"50.00%",res_havoc:"50.00%"},{name:"100等抗性60白板",level:"100",def:"1592",res_physics:"60.00%",res_glacio:"60.00%",res_fusion:"60.00%",res_electro:"60.00%",res_aero:"60.00%",res_spectro:"60.00%",res_havoc:"60.00%"},{name:"100等抗性70白板",level:"100",def:"1592",res_physics:"70.00%",res_glacio:"70.00%",res_fusion:"70.00%",res_electro:"70.00%",res_aero:"70.00%",res_spectro:"70.00%",res_havoc:"70.00%"},{name:"100等抗性80白板",level:"100",def:"1592",res_physics:"80.00%",res_glacio:"80.00%",res_fusion:"80.00%",res_electro:"80.00%",res_aero:"80.00%",res_spectro:"80.00%",res_havoc:"80.00%"}],is=Ls,Cs=xs("monster",{state:()=>({}),actions:{getMonsterItems(){return is.map((s,t,e)=>({title:s.name,value:s}))},getMonsterItemByName(S){for(const s of is)if(s.name===S)return{title:s.name,value:s}}}});class j{constructor(s={}){i(this,"name","");i(this,"level","");i(this,"def","");i(this,"res_physics","");i(this,"res_glacio","");i(this,"res_fusion","");i(this,"res_electro","");i(this,"res_aero","");i(this,"res_spectro","");i(this,"res_havoc","");i(this,"_item",{title:"",value:void 0});!s||Object.keys(s).length===0||Object.assign(this,s)}getJson(){return JSON.parse(JSON.stringify(this))}updateByMonsterItem(s){if(!s)return;const t=s;this.name=t.name,this.level=t.level,this.def=t.def,this.res_physics=t.res_physics,this.res_glacio=t.res_glacio,this.res_fusion=t.res_fusion,this.res_electro=t.res_electro,this.res_aero=t.res_aero,this.res_spectro=t.res_spectro,this.res_havoc=t.res_havoc}updateByName(s){const e=Cs().getMonsterItemByName(s);e&&this.updateByMonsterItem(e.value)}}class Ms{constructor(s={}){i(this,"resonator",new U);i(this,"weapon",new P);i(this,"echoes",new G);i(this,"buffs",new J);i(this,"monster",new j);if(!s||Object.keys(s).length===0)return;const{resonator:t,weapon:e,echoes:a,buffs:_,monster:r}=s;this.resonator=new U(t),this.weapon=new P(e),this.echoes=new G(a),!this.echoes.resonator_name&&this.resonator.name&&(this.echoes.resonator_name=this.resonator.name),this.buffs=new J(_),this.monster=new j(r)}}class Us{constructor(){i(this,"base_attr",[]);i(this,"base_attr_p",[]);i(this,"base_attr_a",[]);i(this,"skill_dmg_addition",[]);i(this,"magnifier",[]);i(this,"amplifier",[]);i(this,"bonus",[]);i(this,"crit_rate",[]);i(this,"crit_dmg",[]);i(this,"ignore_def",[]);i(this,"reduce_res",[])}reset(){this.base_attr=[],this.base_attr_p=[],this.base_attr_a=[],this.skill_dmg_addition=[],this.magnifier=[],this.amplifier=[],this.bonus=[],this.crit_rate=[],this.crit_dmg=[],this.ignore_def=[],this.reduce_res=[]}}class Ps{constructor(){i(this,"labels",[]);i(this,"resonator_name","");i(this,"skill_id","");i(this,"resonator_level","");i(this,"resonator_skill_level","");i(this,"resonator_skill_element","");i(this,"resonator_skill_base_attr","");i(this,"resonator_skill_type","");i(this,"resonator_skill_type_bonus","");i(this,"resonator_skill_dmg","");i(this,"resonator_skill_dmg_addition","");i(this,"echo_element","");i(this,"echo_skill_base_attr","");i(this,"echo_skill_dmg","");i(this,"damage_no_crit","");i(this,"damage_crit","");i(this,"damage","");i(this,"result_element","");i(this,"result_bonus_type","");i(this,"result_bonus_types",[]);i(this,"result_skill_base_attribute","");i(this,"result_skill_dmg","");i(this,"result_skill_hit","1");i(this,"result_hp","");i(this,"result_hp_addition","");i(this,"result_hp_p","");i(this,"result_atk","");i(this,"result_atk_addition","");i(this,"result_atk_p","");i(this,"result_def","");i(this,"result_def_addition","");i(this,"result_def_p","");i(this,"result_crit_rate","");i(this,"result_crit_dmg","");i(this,"result_magnifier","");i(this,"result_amplifier","");i(this,"result_bonus","");i(this,"result_ignore_def","");i(this,"result_reduce_res","");i(this,"monster_level","");i(this,"monster_def","");i(this,"monster_res","");i(this,"hits","");i(this,"real_dmg_no_crit","");i(this,"real_dmg_crit","");i(this,"action","");i(this,"time_start","");i(this,"time_end","");i(this,"buffs",[])}}class js{constructor(s=new U,t=new P,e=new G,a=new J,_=new j){i(this,"id","");i(this,"data",new Ms);i(this,"regions",new Us);i(this,"result",new Ps);this.data.resonator=s,this.data.weapon=t,this.data.echoes=e,!this.data.echoes.resonator_name&&this.data.resonator.name&&(this.data.echoes.resonator_name=this.data.resonator.name),this.data.buffs=a,this.data.monster=_}reset(){this.regions.reset()}getBaseRowBuffs(){const s=[],t=new B;t.category=k.BASE,t.source=k.BASE,t.type=n.CRIT_RATE,t.value="0.05",t.stack="1",t.updateId(),s.push(t);const e=new B;return e.category=k.BASE,e.source=k.BASE,e.type=n.CRIT_DMG,e.value="1.5",e.stack="1",e.updateId(),s.push(e),s}getRowBuffs(){this.data.echoes.updateSummaryByEchoes();let s=this.data.resonator.getBaseAttrs(),t=[];this.data.resonator.skill.base_attr===c.ATK&&(t=this.data.weapon.getBaseAttrs());const e=this.getBaseRowBuffs(),a=this.getMonsterResRowBuffs(),_=this.data.resonator.getRowBuffs(),r=this.data.resonator.getSkillRowBuffs(),b=this.data.weapon.getRowBuffs(),N=this.data.echoes.getRowBuffs(),A=this.data.echoes.getSonataRowBuffs(),I=this.data.echoes.getPassiveSkillRowBuffs(),w=this.data.buffs.getRowBuffs();return[...e,...a,...s,...t,..._,...r,...b,...N,...A,...I,...w]}getMonsterRes(){const s=this.data.resonator.skill.elment_zh_tw;let t;switch(s){case o.GLACIO:t=this.data.monster.res_glacio;break;case o.FUSION:t=this.data.monster.res_fusion;break;case o.ELECTRO:t=this.data.monster.res_electro;break;case o.AERO:t=this.data.monster.res_aero;break;case o.SPECTRO:t=this.data.monster.res_spectro;break;case o.HAVOC:t=this.data.monster.res_havoc;break;default:t="0.2";break}return d(t)}getFinalMonsterRes(){const s=this.regions.reduce_res;let t=new u(0);return s.forEach((e,a)=>{const _=new u(d(e.value)),r=new u(d(e.stack)),b=_.times(r);a===0?t=b:(t||(t=new u(d(t))),t=t.minus(b))}),t}getMonsterResRowBuffs(){const s=[],t=new B;return t.category=k.MONSTER,t.source=this.data.monster.name,t.type=n.REDUCE_RES,t.value=this.getMonsterRes().toString(),t.stack="1",t.element=this.data.resonator.skill.elment_zh_tw,t.updateId(),s.push(t),s}updateId(){this.id=Bs(JSON.stringify(this.data))}updateRegions(s){const t=this.data.resonator.skill.base_attr;s.forEach(e=>{switch(e.type){case W.ATTR:this.regions.base_attr.push(e);break;case n.SKILL_DMG_ADDITION:this.regions.skill_dmg_addition.push(e);break;case n.MAGNIFIER:this.regions.magnifier.push(e);break;case n.AMPLIFIER:this.regions.amplifier.push(e);break;case n.BONUS:if(!e.element&&!e.skill_bonus_type){this.regions.bonus.push(e);break}if(e.element&&e.skill_bonus_type)throw new Error("`element` and `skill_bonus_type` should not have values at the same time.");if(this.data.resonator.skill.bonus_types.includes(e.element)||this.data.resonator.skill.bonus_types.includes(e.skill_bonus_type)){this.regions.bonus.push(e);break}break;case n.HP_P:t===c.HP&&this.regions.base_attr_p.push(e);break;case n.HP:t===c.HP&&this.regions.base_attr_a.push(e);break;case n.ATK_P:t===c.ATK&&this.regions.base_attr_p.push(e);break;case n.ATK:t===c.ATK&&this.regions.base_attr_a.push(e);break;case n.DEF_P:t===c.DEF&&this.regions.base_attr_p.push(e);break;case n.DEF:t===c.DEF&&this.regions.base_attr_a.push(e);break;case n.CRIT_RATE:this.regions.crit_rate.push(e);break;case n.CRIT_DMG:this.regions.crit_dmg.push(e);break;case n.IGNORE_DEF:this.regions.ignore_def.push(e);break;case n.REDUCE_RES:this.regions.reduce_res.push(e);break}})}sumRegion(s){let t=new u(0);return s.forEach(e=>{const a=new u(d(e.value)),_=new u(d(e.stack));t=t.plus(a.times(_))}),t}calculate(){this.updateId(),this.reset();const s=this.getRowBuffs();this.updateRegions(s);const t=this.sumRegion(this.regions.base_attr),e=this.sumRegion(this.regions.base_attr_p),a=this.sumRegion(this.regions.base_attr_a),_=t.times(e.plus(new u(1))).plus(a),r=this.sumRegion(this.regions.skill_dmg_addition),b=this.sumRegion(this.regions.magnifier),N=b.plus(new u(1)),A=this.sumRegion(this.regions.amplifier),I=A.plus(new u(1)),w=this.sumRegion(this.regions.bonus),Ss=w.plus(new u(1)),z=this.sumRegion(this.regions.crit_dmg);let T=this.sumRegion(this.regions.crit_rate);T.gte(new u(1))&&(T=new u(1));const X=new u(d(this.data.resonator.level)),Z=new u(d(this.data.monster.level)).times(new u(8)).plus(new u(792)),q=this.sumRegion(this.regions.ignore_def),bs=X.times(new u(8)).plus(new u(800)).dividedBy(X.times(new u(8)).plus(new u(800)).plus(Z.times(new u(1).minus(q)))),y=this.getFinalMonsterRes(),gs=new u(this.getMonsterRes()).minus(y);let D;y.lt(new u(0))?D=new u(1).minus(y.dividedBy(new u(2))):y.gte(new u(.8))?D=new u(1).dividedBy(y.times(new u(5)).plus(new u(1))):D=new u(1).minus(y);const ks=new u(this.data.resonator.skill.hit),V=_.times(r).times(N).times(I).times(Ss).times(bs).times(D).times(ks),Q=V.times(z),As=Q.times(T).plus(new u(1).minus(T).times(V));if(this.result.resonator_name=this.data.resonator.name,this.result.skill_id=this.data.resonator.skill.id,this.result.resonator_level=this.data.resonator.level,this.result.resonator_skill_level=this.data.resonator.skill.level,this.result.resonator_skill_element=this.data.resonator.skill.elment_zh_tw,this.result.resonator_skill_base_attr=this.data.resonator.skill.base_attr,this.result.resonator_skill_type=this.data.resonator.skill.type,this.result.resonator_skill_dmg=this.data.resonator.skill.dmg,this.regions.skill_dmg_addition.length>1){let Is=this.sumRegion(this.regions.skill_dmg_addition.slice(1));this.result.resonator_skill_dmg_addition=Is.toString()}switch(this.result.damage=E(As),this.result.damage_crit=E(Q),this.result.damage_no_crit=E(V),this.result.result_element=this.data.resonator.skill.elment_zh_tw,this.result.result_bonus_types=this.data.resonator.skill.bonus_types,this.result.result_skill_base_attribute=this.data.resonator.skill.base_attr,this.result.result_skill_dmg=this.data.resonator.skill.dmg,this.result.result_skill_hit=this.data.resonator.skill.hit,this.data.resonator.skill.base_attr){case c.HP:this.result.result_hp=E(t),this.result.result_hp_addition=E(a),this.result.result_hp_p=E(e);break;case c.DEF:this.result.result_def=E(t),this.result.result_def_addition=E(a),this.result.result_def_p=E(e);break;case c.ATK:default:this.result.result_atk=E(t),this.result.result_atk_addition=E(a),this.result.result_atk_p=E(e);break}this.result.result_crit_rate=E(T),this.result.result_crit_dmg=E(z),this.result.result_magnifier=E(b),this.result.result_amplifier=E(A),this.result.result_bonus=E(w),this.result.result_ignore_def=E(q),this.result.result_reduce_res=E(gs),this.result.monster_level=this.data.monster.level,this.result.monster_def=E(Z),this.result.monster_res=E(this.getMonsterRes()),this.result.hits=this.data.resonator.skill.hit,this.result.action}}class Gs{constructor(s,t,e){i(this,"resonator");i(this,"weapon");i(this,"echoes");if(this.resonator=s,this.weapon=t,this.echoes=e,!this.echoes.resonator_name&&this.resonator.name&&(this.echoes.resonator_name=this.resonator.name),e.echoes.length!==5)throw new Error("`echoStores` length must be exactly 5")}getBaseAbbr(){const s=this.echoes.base_attr;let t;switch(s){case c.HP:t=R.HP;break;case c.DEF:t=R.DEF;break;case c.ATK:default:t=R.ATK;break}return t}getCritAttr(){const s=parseFloat(this.weapon.stat_bonus.crit_rate),t=parseFloat(this.weapon.stat_bonus.crit_dmg);return!s&&t?R.CRIT_RATE:s&&!t?R.CRIT_DMG:R.CRIT_DMG}updateSubAffixesWithAffixes151(s){switch(this.echoes.base_attr){case c.HP:s.sub_affix.hp="270",s.sub_affix.hp_p="0.054";break;case c.DEF:s.sub_affix.def="30",s.sub_affix.def_p="0.068325";break;case c.ATK:default:s.sub_affix.atk="24",s.sub_affix.atk_p="0.054";break}s.sub_affix.crit_rate="0.084",s.sub_affix.crit_dmg="0.1008",s.sub_affix.bonus_resonance_skill="0.016",s.sub_affix.bonus_basic_attack="0.016",s.sub_affix.bonus_heavy_attack="0.016",s.sub_affix.bonus_resonance_liberation="0.016"}updateSubAffixesWithAffixes20Small(s){switch(this.echoes.base_attr){case c.HP:s.sub_affix.hp="450",s.sub_affix.hp_p="0.09";break;case c.DEF:s.sub_affix.def="50",s.sub_affix.def_p="0.113875";break;case c.ATK:default:s.sub_affix.atk="40",s.sub_affix.atk_p="0.09";break}s.sub_affix.crit_rate="0.084",s.sub_affix.crit_dmg="0.168"}updateSubAffixesWithAffixes20SkillBonus(s){switch(this.echoes.base_attr){case c.HP:s.sub_affix.hp_p="0.09";break;case c.DEF:s.sub_affix.def_p="0.113875";break;case c.ATK:default:s.sub_affix.atk_p="0.09";break}switch(s.sub_affix.crit_rate="0.084",s.sub_affix.crit_dmg="0.168",this.echoes.main_skill_bonus){case l.SKILL:s.sub_affix.bonus_resonance_skill="0.09";break;case l.BASIC:s.sub_affix.bonus_basic_attack="0.09";break;case l.HEAVY:s.sub_affix.bonus_heavy_attack="0.09";break;case l.LIBERATION:s.sub_affix.bonus_resonance_liberation="0.09";break}}updateBase(){this.echoes.echoes.forEach((s,t)=>{switch(s.resetMainAffix(),s.resetSubAffix(),this.echoes.policy){case O.AFFIXES_15_1:this.updateSubAffixesWithAffixes151(s);break;case O.AFFIXES_20_SMALL:this.updateSubAffixesWithAffixes20Small(s);break;case O.AFFIXES_20_SKILL_BONUS:this.updateSubAffixesWithAffixes20SkillBonus(s);break}})}updateFixedMainAffix(s,t){const e=Rs(t);for(const[a,_]of Object.entries(e))s.main_affix[a]=_,s._fixed_main_affix_key=a}updateMainAffixItem(s,t){s._main_affix_item={title:$(t),value:t}}updateCost4Echo(s,t){const e="4";s.cost=e,s.abbr=t,s.updateMainAffixKeysByCost(),this.updateFixedMainAffix(s,e);const a=C(e);switch(t){case R.HP:s.main_affix.hp_p=a.hp_p,this.updateMainAffixItem(s,"hp_p");break;case R.ATK:s.main_affix.atk_p=a.atk_p,this.updateMainAffixItem(s,"atk_p");break;case R.DEF:s.main_affix.def_p=a.def_p,this.updateMainAffixItem(s,"def_p");break;case R.BONUS_HEALING:s.main_affix.bonus_healing=a.bonus_healing,this.updateMainAffixItem(s,"bonus_healing");break;case R.CRIT_RATE:s.main_affix.crit_rate=a.crit_rate,this.updateMainAffixItem(s,"crit_rate");break;case R.CRIT_DMG:default:s.main_affix.crit_dmg=a.crit_dmg,this.updateMainAffixItem(s,"crit_dmg");break}}updateCost3Echo(s,t){const e="3";s.cost=e,s.abbr=t,s.updateMainAffixKeysByCost(),this.updateFixedMainAffix(s,e);const a=C(e);switch(t){case R.HP:s.main_affix.hp_p=a.hp_p,this.updateMainAffixItem(s,"hp_p");break;case R.ATK:s.main_affix.atk_p=a.atk_p,this.updateMainAffixItem(s,"atk_p");break;case R.DEF:s.main_affix.def_p=a.def_p,this.updateMainAffixItem(s,"def_p");break;case R.ENERGY_REGEN:s.main_affix.energy_regen=a.energy_regen,this.updateMainAffixItem(s,"energy_regen");break;case o.GLACIO:s.main_affix.bonus_glacio=a.bonus_glacio,this.updateMainAffixItem(s,"bonus_glacio");break;case o.FUSION:s.main_affix.bonus_fusion=a.bonus_fusion,this.updateMainAffixItem(s,"bonus_fusion");break;case o.ELECTRO:s.main_affix.bonus_electro=a.bonus_electro,this.updateMainAffixItem(s,"bonus_electro");break;case o.AERO:s.main_affix.bonus_aero=a.bonus_aero,this.updateMainAffixItem(s,"bonus_aero");break;case o.SPECTRO:s.main_affix.bonus_spectro=a.bonus_spectro,this.updateMainAffixItem(s,"bonus_spectro");break;case o.HAVOC:s.main_affix.bonus_havoc=a.bonus_havoc,this.updateMainAffixItem(s,"bonus_havoc");break}}updateCost1Echo(s,t){const e="1";s.cost=e,s.abbr=t,s.updateMainAffixKeysByCost(),this.updateFixedMainAffix(s,e);const a=C(e);switch(t){case R.HP:s.main_affix.hp_p=a.hp_p,this.updateMainAffixItem(s,"hp_p");break;case R.ATK:s.main_affix.atk_p=a.atk_p,this.updateMainAffixItem(s,"atk_p");break;case R.DEF:s.main_affix.def_p=a.def_p,this.updateMainAffixItem(s,"def_p");break}}updateEcho(s,t,e){switch(t=t.toString(),t){case"4":e||(e=this.getCritAttr()),this.updateCost4Echo(this.echoes.echoes[s],e);break;case"3":e||(e=this.resonator.element_zh_tw),this.updateCost3Echo(this.echoes.echoes[s],e);break;case"1":e||(e=this.getBaseAbbr()),this.updateCost1Echo(this.echoes.echoes[s],e);break;default:return}}update(s,t,e,a,_,r,b,N,A,I){!this.echoes.policy||this.echoes.echoes.length===0||(this.updateBase(),this.updateEcho(0,s,r),this.updateEcho(1,t,b),this.updateEcho(2,e,N),this.updateEcho(3,a,A),this.updateEcho(4,_,I))}update43311(s="",t="",e="",a="",_=""){this.update("4","3","3","1","1",s,t,e,a,_)}update43311With2Elem(){this.echoes.base_attr,this.resonator.element_zh_tw}update43311With1Elem1Attr(){this.resonator.element_zh_tw}update43311With2Attr(){}update43311With2EnergyRegen(){}update43311With1EnergyRegen1Elem(){this.resonator.element_zh_tw}update43311With1EnergyRegen1Attr(){}}function Ws(S,s,t){new Gs(S,s,t).update43311()}export{J as R,j as a,G as b,P as c,U as d,Ws as e,Gs as f,js as g,Ms as h,Cs as u};
