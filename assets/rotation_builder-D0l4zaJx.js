import{V as oe,a as j,_ as ae}from"./VFileInput-CBHP790Q.js";import{d as ne,S as se,E as ue,P as s,ae as ie,e as c,o as p,w as o,Q as V,a,V as C,I as v,ag as d,ah as u,J as i,a5 as re,L as O,b as de}from"./index-CLO620bX.js";import{_ as me}from"./Rotation-ug0sn0K5.js";import{u as fe}from"./resonator-BEbILlhW.js";import{g as ve,a as ce}from"./rotation-D42qN3bH.js";import{s as pe}from"./VTooltip-BknPKQzR.js";import{V as S,a as Ve}from"./VTextarea-CdKsaJNu.js";import{V as B}from"./VCard-Cc66bWqn.js";import{V as A}from"./VTextField-BoLNhwR5.js";import{V as ge,a as F}from"./VDataTable-CXEzddBs.js";import{b as q}from"./route-block-B_A1xBdJ.js";import"./VList-Cvukp5Vg.js";import"./VAvatar-CjlGo4Xc.js";import"./index-BpA_PkR6.js";import"./ImageDownloadPanel.vue_vue_type_script_setup_true_lang-eInAz-Wm.js";const we={class:"d-flex flex-column"},be={class:"d-flex flex-row ml-auto"},_e={class:"d-flex flex-column"},$e={class:"d-flex flex-row ml-auto"},ke={class:"d-flex flex-column"},Ce={class:"d-flex flex-row ml-auto"},Ne={class:"d-flex flex-column"},ye={class:"d-flex flex-row ml-auto"},he={class:"container d-flex flex-column"},xe={class:"d-flex flex-row ml-auto mb-2"},z=ne({__name:"rotation_builder",setup(Ue){const{t:R}=se();let g=ue().query.spoiler;g==="true"||g===!0?g=!0:g=!1;const L=fe().getNames(g),r=s(void 0),E=s([]),N=s(!1),I=s([]),w=s(!1),y=s(void 0),b=s(!1),h=s(void 0),_=s(!1),x=s(void 0),U=s(""),$=s(!1),k=s(void 0),P=[{title:R("general.row"),key:"id",width:"100px"},{title:R("general.resonator"),key:"resonator_name",width:"200px"},{title:R("general.action"),key:"action",width:"200px"},{title:"",key:"tools"}],n=s([{id:0,resonator_name:"",action:"",selected:!1,comment:""}]);function D(){n.value.forEach((l,e)=>{l.id=e})}function Q(){let l;N.value?l=!0:l=!1,n.value.forEach(e=>{e.selected=l}),r.value=void 0}function G(){let l=0;return n.value.forEach(e=>{e.selected&&(l+=1)}),l}function H(l){const e=l.selected;e&&(r.value=l.id),!e&&l.id===r.value&&(r.value=void 0),N.value=!1}function K(){const l=n.value[k.value];l.id===k.value&&(l.comment=U.value.toString(),$.value=!1,U.value="")}function J(l,e){const m=[];for(let f=0;f<e;f++)m.push({id:0,resonator_name:"",action:"",selected:!1,comment:""});const t=[...n.value.slice(0,l),...m,...n.value.slice(l)];n.value=t,D()}function M(){const l=Number(r.value);if(isNaN(l))return;const e=Number(y.value);isNaN(e)||(J(l,e),w.value=!1,y.value=void 0)}function W(){let l=Number(r.value);if(isNaN(l))return;const e=Number(h.value);isNaN(e)||(l+=1,J(l,e),b.value=!1,h.value=void 0)}function X(){D();const l=n.value.length,e=l+Number(x.value);if(typeof e=="number"){for(let m=l;m<e;m++)n.value.push({id:m,resonator_name:"",action:"",selected:!1,comment:""});_.value=!1,x.value=void 0}}function Y(){const l=[];n.value.forEach((e,m)=>{e.selected||l.push(e)}),n.value=l,D()}function Z(){pe(n.value)}const ee=s("");function le(l){const e=l.target;if(!e.files||e.files.length===0)return;const m=e.files[0];ee.value=m.name;const t=new FileReader;t.onload=f=>{var T;try{n.value=JSON.parse((T=f.target)==null?void 0:T.result)}catch(te){console.error("Invalid JSON file",te)}},t.readAsText(m)}return ie(()=>JSON.stringify(n.value),()=>{const l=[];n.value.forEach(e=>{e.resonator_name&&e.action&&l.push(e)}),l.length>0?I.value=ve(l):l.length===0&&(I.value=[])}),(l,e)=>{const m=ae;return p(),c(m,null,{default:o(()=>[r.value!==void 0?(p(),c(S,{key:0,modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),width:"auto"},{default:o(()=>[a(B,{"min-width":"400",title:l.$t("general.insert_above_at_n",{n:r.value+1})},{default:o(()=>[a(C,null,{default:o(()=>[v("div",we,[a(A,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),v("div",be,[a(d,{class:"mr-2",onClick:e[1]||(e[1]=t=>w.value=!1)},{default:o(()=>[u(i(l.$t("general.cancel")),1)]),_:1}),a(d,{onClick:M},{default:o(()=>[u(i(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):V("",!0),r.value!==void 0?(p(),c(S,{key:1,modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=t=>b.value=t),width:"auto"},{default:o(()=>[a(B,{"min-width":"400",title:l.$t("general.insert_below_at_n",{n:r.value+1})},{default:o(()=>[a(C,null,{default:o(()=>[v("div",_e,[a(A,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=t=>h.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),v("div",$e,[a(d,{class:"mr-2",onClick:e[4]||(e[4]=t=>b.value=!1)},{default:o(()=>[u(i(l.$t("general.cancel")),1)]),_:1}),a(d,{onClick:W},{default:o(()=>[u(i(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):V("",!0),a(S,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=t=>_.value=t),width:"auto"},{default:o(()=>[a(B,{"min-width":"400",title:l.$t("general.insert_bottom")},{default:o(()=>[a(C,null,{default:o(()=>[v("div",ke,[a(A,{modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=t=>x.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),v("div",Ce,[a(d,{class:"mr-2",onClick:e[7]||(e[7]=t=>_.value=!1)},{default:o(()=>[u(i(l.$t("general.cancel")),1)]),_:1}),a(d,{onClick:X},{default:o(()=>[u(i(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),k.value!==void 0?(p(),c(S,{key:2,modelValue:$.value,"onUpdate:modelValue":e[11]||(e[11]=t=>$.value=t),width:"auto"},{default:o(()=>[a(B,{"min-width":"400",title:l.$t("general.nth_row_comment",{n:k.value+1})},{default:o(()=>[a(C,null,{default:o(()=>[v("div",Ne,[a(Ve,{modelValue:U.value,"onUpdate:modelValue":e[9]||(e[9]=t=>U.value=t)},null,8,["modelValue"]),v("div",ye,[a(d,{class:"mr-2",onClick:e[10]||(e[10]=t=>{$.value=!1})},{default:o(()=>[u(i(l.$t("general.cancel")),1)]),_:1}),a(d,{onClick:K},{default:o(()=>[u(i(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):V("",!0),a(C,{class:"mb-12"},{default:o(()=>[v("div",he,[v("div",xe,[a(oe,{"max-width":"200","min-width":"200",label:l.$t("general.load_file"),class:"mr-2",accept:".json",variant:"outlined",density:"compact",onChange:le},null,8,["label"]),G()>0?(p(),c(d,{key:0,class:"mr-2",onClick:e[12]||(e[12]=t=>{r.value=void 0})},{default:o(()=>[u(i(l.$t("general.delete")),1)]),_:1})):V("",!0),r.value!==void 0?(p(),c(d,{key:1,class:"mr-2",onClick:e[13]||(e[13]=t=>w.value=!0)},{default:o(()=>[u(i(l.$t("general.insert_above")),1)]),_:1})):V("",!0),r.value!==void 0?(p(),c(d,{key:2,class:"mr-2",onClick:e[14]||(e[14]=t=>b.value=!0)},{default:o(()=>[u(i(l.$t("general.insert_below")),1)]),_:1})):V("",!0),a(d,{class:"mr-2",onClick:e[15]||(e[15]=t=>_.value=!0)},{default:o(()=>[u(i(l.$t("general.insert_bottom")),1)]),_:1}),a(d,{onClick:Z},{default:o(()=>[u(i(l.$t("general.download_json")),1)]),_:1})]),a(ge,{class:"table mb-2",headers:P,items:n.value,"items-per-page":n.value.length,"show-select":"",selected:E.value,"onUpdate:selected":e[18]||(e[18]=t=>E.value=t),"disable-sort":"","hide-default-footer":""},{"item.id":o(({item:t})=>[u(i(l.$t("general.nth_row",{n:t.id+1})),1)]),"header.data-table-select":o(()=>[a(F,{modelValue:N.value,"onUpdate:modelValue":[e[16]||(e[16]=t=>N.value=t),e[17]||(e[17]=t=>Q())],color:"primary"},null,8,["modelValue"])]),"item.data-table-select":o(({item:t})=>[a(F,{modelValue:t.selected,"onUpdate:modelValue":[f=>t.selected=f,f=>H(t)]},null,8,["modelValue","onUpdate:modelValue"])]),"item.resonator_name":o(({item:t})=>[a(j,{modelValue:t.resonator_name,"onUpdate:modelValue":f=>t.resonator_name=f,items:O(L),variant:"outlined",width:"180px",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),"item.action":o(({item:t})=>[a(j,{modelValue:t.action,"onUpdate:modelValue":f=>t.action=f,items:O(ce)(),variant:"outlined",width:"180px",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),"item.tools":o(({item:t})=>[a(re,{class:"me-2",size:"small",onClick:f=>{$.value=!0,k.value=t.id}},{default:o(()=>e[19]||(e[19]=[u(" mdi-pencil ")])),_:2},1032,["onClick"])]),_:1},8,["items","items-per-page","selected"]),(p(),c(me,{rotation:I.value,key:JSON.stringify(n.value)},null,8,["rotation"]))])]),_:1})]),_:1})}}});typeof q=="function"&&q(z);const Ge=de(z,[["__scopeId","data-v-4d8e0a89"]]);export{Ge as default};
