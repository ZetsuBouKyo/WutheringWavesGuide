var Ns=Object.defineProperty;var Os=(b,s,e)=>s in b?Ns(b,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):b[s]=e;var i=(b,s,e)=>Os(b,typeof s!="symbol"?s+"":s,e);import{d as E,c as L,D as u,m as Bs,t as p}from"./utils-CVNhfOQy.js";import{t as m,v as ws,r as B,S as h,w as k,x as W,B as n,u as ss,k as x,l as c,y as vs,W as ys,z as M,d as Ts,h as D,j as R,A as bs,g as J,C,E as o,D as es,F as l,G as d}from"./resonator-L2IJcEFW.js";import{aZ as $,ai as xs}from"./index-_rGMOtXQ.js";import{A as O}from"./affix-NmzP8Gk5.js";const f={FREEZING_FROST:"凝夜白霜",MOLTEN_RIFT:"熔山裂谷",VOID_THUNDER:"徹空冥雷",SIERRA_GALE:"嘯谷長風",CELESTIAL_LIGHT:"浮星祛暗",SUN_SINKING_ECLIPSE:"沉日劫明",REJUVENATING_GLOW:"隱世回光",MOONLIT_CLOUDS:"輕雲出月",LINGERING_TUNES:"不絕餘音",FROSTY_RESOLVE:"凌冽決斷之心",ETERNAL_RADIANCE:"此間永駐之光",MIDNIGHT_VEIL:"幽夜隱匿之帷",EMPYREAN_ANTHEM:"高天共奏之曲",TIDEBREAKING_COURAGE:"無懼浪濤之勇"};class v{constructor(s={}){i(this,"id","");i(this,"type","");i(this,"level","");i(this,"base_attr","");i(this,"bonus_types",[]);i(this,"elment_zh_tw","");i(this,"dmg","");i(this,"hit","1");!s||Object.keys(s).length===0||Object.assign(this,s)}duplicate(){const s=new v;return s.id=this.id,s.type=this.type,s.level=this.level,s.base_attr=this.base_attr,s.bonus_types=this.bonus_types,s.elment_zh_tw=this.elment_zh_tw,s.dmg=this.dmg,s}getBonusTypesString(){return this.bonus_types.join(", ")}}class G{constructor(s={}){i(this,"id","");i(this,"no","");i(this,"name","");i(this,"element_en","");i(this,"element_zh_tw","");i(this,"level","90");i(this,"chain","0");i(this,"hp","");i(this,"atk","");i(this,"def","");i(this,"energy_regen","100.00%");i(this,"normal_attack_lv","10");i(this,"resonance_skill_lv","10");i(this,"forte_circuit_lv","10");i(this,"resonance_liberation_lv","10");i(this,"intro_skill_lv","10");i(this,"inherent_skill_1",!0);i(this,"inherent_skill_2",!0);i(this,"stat_bonus",new m);i(this,"skill",new v);i(this,"_skill_item",{title:"",value:void 0});i(this,"_info");if(!s||Object.keys(s).length===0)return;const{stat_bonus:e,skill:t,_skill_item:a,_info:_,...r}=s;Object.assign(this,r),this.stat_bonus=new m(e),this.skill=new v(t),s._skill_item.title&&(this._skill_item.title=s._skill_item.title),s._skill_item.value&&(this._skill_item.value=new v(s._skill_item.value)),this._info=new ws(_)}duplicate(){const s=new G;return s.id=this.id,s.no=this.no,s.name=this.name,s.element_zh_tw=this.element_zh_tw,s.level=this.level,s.chain=this.chain,s.hp=this.hp,s.atk=this.atk,s.def=this.def,s.energy_regen=this.energy_regen,s.normal_attack_lv=this.normal_attack_lv,s.resonance_skill_lv=this.resonance_skill_lv,s.forte_circuit_lv=this.forte_circuit_lv,s.resonance_liberation_lv=this.resonance_liberation_lv,s.intro_skill_lv=this.intro_skill_lv,s.inherent_skill_1=this.inherent_skill_1,s.inherent_skill_2=this.inherent_skill_2,s.stat_bonus=this.stat_bonus.duplicate(),s.skill=this.skill.duplicate(),s._skill_item={title:this._skill_item.title,value:void 0},this._skill_item.value!==void 0&&(s._skill_item.value=this._skill_item.value.duplicate()),this._info!==void 0&&(s._info=this._info.duplicate()),s}getId(){return`+${this.chain}${this.name}`}getJson(){return JSON.parse(JSON.stringify(this))}getBaseAttrs(){const s=[],e=new B;e.stack="1";let t,a=this.skill.base_attr;switch(this.skill.base_attr){case h.HP:t=E(this.hp).toString();break;case h.DEF:t=E(this.def).toString();break;case h.ATK:default:t=E(this.atk).toString(),a=h.ATK;break}return this.name&&(a=`${this.name}-${a}`),e.category=k.ATTR,e.source=a,e.value=t,e.type=W.ATTR,e.updateId(),s.push(e),s}getRowBuffs(){return this.stat_bonus.getRowBuffs(this.name)}getSkillRowBuffs(){const s=[],e=new B;e.category=k.RESONATOR,e.type=n.SKILL_DMG_ADDITION,e.value=E(this.skill.dmg).toString(),e.stack="1";let t="";return this.name&&(t=this.name),this.skill.type&&(t=`${t}-${this.skill.type}`),this.skill.id&&(t=`${t}-${this.skill.id}`),e.source=t,e.updateId(),e.value&&s.push(e),s}async updateByLevel(s=""){var e;if(s?this.level=s:s=this.level,!!s&&this.name){if(!((e=this._info)!=null&&e.attrs.length)){const a=await ss().getInfoByName(this.name);this._info=a}this.hp=this._info.getHp(s),this.atk=this._info.getAtk(s),this.def=this._info.getDef(s)}}async updateByName(){const s=ss();this.stat_bonus=new m,this.skill=new v,this._skill_item={title:"",value:void 0};const e=this.name,t=s.getNoByName(e);if(!t)return;this.no=t;const a=await s.getInfoByName(e);this._info=a,this.element_en=a.element_en,this.element_zh_tw=a.element_zh_tw,this.updateByLevel();const _=a.stat_bonus;Object.keys(_).forEach(r=>{const S=_[r];this.stat_bonus[r]=S})}updateSkillDmg(s){if(s.dmg){this.skill.dmg=s.dmg;return}const e=this.skill.type;let t;switch(e){case x.NORMAL_ATTACK:t=this.normal_attack_lv;break;case x.RESONANCE_SKILL:t=this.resonance_skill_lv;break;case x.FORTE_CIRCUIT:t=this.forte_circuit_lv;break;case x.RESONANCE_LIBERATION:t=this.resonance_liberation_lv;break;case x.INTRO_SKILL:t=this.intro_skill_lv;break;default:t="10"}this.skill.level=t,this.skill.dmg=s[`lv${t}`]}updateSkill(s=void 0){if(!s){if(!this._skill_item)return;s=this._skill_item.value}s&&(this.skill=new v,this.skill.id=s.id,this.skill.type=s.skill_type,this.skill.base_attr=s.base_attr,s.element&&(this.skill.elment_zh_tw=s.element,this.skill.bonus_types.push(s.element)),s.bonus_type&&this.skill.bonus_types.push(s.bonus_type),s.coordinated&&this.skill.bonus_types.push(c.COORDINATED_ATTACK),this.updateSkillDmg(s))}updateSkillById(s){var t;let e=(t=this._info)==null?void 0:t.getDamageSkillItemById(s);e||(e=vs(s)),e&&this.updateSkill(e.value)}}class U{constructor(s={}){i(this,"no","");i(this,"name","");i(this,"star","");i(this,"type","");i(this,"level","90");i(this,"tune","1");i(this,"atk","");i(this,"stat_bonus",new m);i(this,"passive_stat_bonus",new m);i(this,"_info");if(!s||Object.keys(s).length===0)return;const{stat_bonus:e,passive_stat_bonus:t,_info:a,..._}=s;Object.assign(this,_),this.stat_bonus=new m(e),this.passive_stat_bonus=new m(t),this._info=new ys(a)}duplicate(){const s=new U;return s.no=this.no,s.name=this.name,s.star=this.star,s.type=this.type,s.level=this.level,s.tune=this.tune,s.atk=this.atk,s.stat_bonus=this.stat_bonus.duplicate(),s.passive_stat_bonus=this.passive_stat_bonus.duplicate(),this._info!==void 0&&(s._info=this._info.duplicate()),s}getId(){return`+${this.tune}${this.name}`}getJson(){return JSON.parse(JSON.stringify(this))}getBaseAttrs(){const s=[],e=new B;let t=h.ATK;return this.name&&(t=`${this.name}-${t}`),e.source=t,e.category=k.ATTR,e.value=this.atk,e.stack="1",e.type=W.ATTR,e.updateId(),e.value&&s.push(e),s}getRowBuffs(){let s="";this.name&&(s=this.name),this.tune&&(s=`${s}-${this.tune}${M.TUNE}`);let e=`${s}-${M.PASSIVE}`;const t=this.passive_stat_bonus.getRowBuffs(e);return[...this.stat_bonus.getRowBuffs(s),...t]}getMaxLevel(){return this._info?this._info.getMaxLevel():"90"}getLevels(){const s=new Array("1","20","20+","40","40+","50","50+","60","60+","70","70+","80","80+","90"),e=[],t=E(this.getMaxLevel());s.forEach(_=>{E(_)<=t&&e.push(_)});const a=e.at(-1);return a&&a.includes("+")&&e.pop(),e}updateRowWeaponByName(){const s=this.name;if(!s)return;const e=Ts();this.stat_bonus=new m,this.passive_stat_bonus=new m;const t=e.getNoByName(s);if(this.no=t,!this.no)return;const a=e.getInfoByNo(t);if(!a)return;this._info=a,this.star=a.star,this.type=a.type;const _=a.getMaxLevel(),r=E(this.level),S=E(_);r>S?this.level=_:r===S&&this.level.includes("+")&&(this.level=_);const N=this.level;if(N){this.atk=a.getAtk(N);const A=a.getStatBonus(N);Object.keys(A).forEach(I=>{const w=A[I];this.stat_bonus[I]=E(w).toString()})}if(this.tune){const A=a.getPassiveStatBonus(this.tune);Object.keys(A).forEach(I=>{const w=A[I];this.passive_stat_bonus[I]=E(w).toString()})}}}const g={HECATE:"赫卡忒",SENTRY_CONSTRUCT:"異構武裝",LORELEI:"羅蕾萊",NIGHTMARE_INFERNO_RIDER:"夢魘·燎照之騎",NIGHTMARE_THUNDERING_MEPHIS:"夢魘·雲閃之鱗",NIGHTMARE_TEMPEST_MEPHIS:"夢魘·朔雷之鱗",DRAGON_OF_DIRGE:"嘆息古龍",NIGHTMARE_CROWNLESS:"夢魘·無冠者",NIGHTMARE_MOURNING_AIX:"夢魘·哀聲鷙",NIGHTMARE_IMPERMANENCE_HERON:"夢魘·無常凶鷺",NIGHTMARE_FEILIAN_BERINGAL:"夢魘·飛廉之猩",CAPITANEUS:"榮光節使",REMINISCENCE_FLEURDELYS:"共鳴迴響·芙露德莉斯",REMINISCENCE_FENRICO:"共鳴迴響·芬萊克",NIGHTMARES_KELPIE:"夢魘·凱爾匹",LIONESS_OF_GLORY:"榮耀獅像",NIGHTMARES_HECATE:"夢魘·赫卡忒"};class H{constructor(s={}){i(this,"no","");i(this,"name","");i(this,"sonata","");i(this,"cost","");i(this,"abbr","");i(this,"main_affix",new m);i(this,"sub_affix",new m);i(this,"_fixed_main_affix_key","");i(this,"_main_affix_item",{title:"",value:void 0});i(this,"_main_affix_items",[]);i(this,"_item",{title:"",value:void 0});i(this,"_sonatas",this.getSonataNames());if(!s||Object.keys(s).length===0)return;const{main_affix:e,sub_affix:t,...a}=s;Object.assign(this,a),this.main_affix=new m(e),this.sub_affix=new m(t)}duplicate(){const s=new H;return s.no=this.no,s.name=this.name,s.sonata=this.sonata,s.main_affix=this.main_affix.duplicate(),s.sub_affix=this.sub_affix.duplicate(),s._fixed_main_affix_key=this._fixed_main_affix_key,s._main_affix_item=JSON.parse(JSON.stringify(this._main_affix_item)),s._main_affix_items=JSON.parse(JSON.stringify(this._main_affix_items)),s._item=JSON.parse(JSON.stringify(this._item)),s._sonatas=JSON.parse(JSON.stringify(this._sonatas)),s}reset(){this.cost="",this._item={title:"",value:void 0},this.resetMainAffix(),this.resetSubAffix()}resetMainAffix(){this.main_affix=new m,this._fixed_main_affix_key="",this._main_affix_item={title:"",value:void 0}}resetSubAffix(){this.sub_affix=new m}getId(){return`${this.cost}${this.abbr}`}getCosts(){return D().getCosts()}getEchoItems(){return D().getEchoItemsForCalculation()}getSonataNames(){return D().getSonataNames()}getSubAffixKeys(){return D().getSubAffixKeys()}updateByCost(s){if(!s)return;switch(this.cost=s,this.updateMainAffixKeysByCost(),this.resetMainAffix(),this.cost){case"4":case"3":this._fixed_main_affix_key=R.ATK;break;case"1":this._fixed_main_affix_key=R.HP;break}const e=bs(this.cost);this.main_affix[this._fixed_main_affix_key]=e[this._fixed_main_affix_key],this._main_affix_item={title:"",value:void 0}}updateByEchoItem(s){(!s||!s.title||!s.value)&&(s=this._item),!(!s||!s.title||!s.value)&&(this.name=s.value.name,s.value.sonatas&&s.value.sonatas.length>0?this._sonatas=s.value.sonatas:this._sonatas=this.getSonataNames(),this.sonata="",this._sonatas.length===1&&(this.sonata=this._sonatas[0]),this._item=s,this.updateByCost(s.value.cost))}updateMainAffix(s){const e=this.cost;if(!s||!e)return;this._main_affix_item={title:J(s),value:s};const t=C(e);this.main_affix[s]=t[s]}updateMainAffixKeysByCost(){const s=this.cost;if(!s)return;const e=C(s);this._main_affix_items=Object.keys(e).map((t,a,_)=>({title:J(t),value:t}))}}class K{constructor(s={}){i(this,"name1","");i(this,"sonatas",[]);i(this,"total_cost",0);i(this,"main_affix",new m);i(this,"sub_affix",new m);i(this,"stat_bonus",new m);if(!s||Object.keys(s).length===0)return;const{main_affix:e,sub_affix:t,...a}=s;Object.assign(this,a),this.main_affix=new m(e),this.sub_affix=new m(t)}duplicate(){const s=new K;return s.name1=this.name1,s.sonatas=JSON.parse(JSON.stringify(this.sonatas)),s.total_cost=this.total_cost,s.main_affix=this.main_affix.duplicate(),s.sub_affix=this.sub_affix.duplicate(),s}getRowBuffs(){const s=this.main_affix.getRowBuffs(`${k.ECHO}-${M.MAIN_AFFIX}`),e=this.sub_affix.getRowBuffs(`${k.ECHO}-${M.SUB_AFFIX}`);return[...s,...e]}getStat(s){return L(this.main_affix[s]).plus(L(this.sub_affix[s])).plus(L(this.stat_bonus[s])).toString()}}class P{constructor(s={}){i(this,"resonator_name","");i(this,"policy","");i(this,"base_attr","");i(this,"main_skill_bonus","");i(this,"echoes",[]);i(this,"summary",new K);if(!s||Object.keys(s).length===0){this.echoes=Array.from({length:5},(_,r)=>new H);return}const{echoes:e,summary:t,...a}=s;Object.assign(this,a),this.echoes=[],e.forEach(_=>{this.echoes.push(new H(_))}),this.summary=new K(t)}duplicate(){const s=new P;return s.resonator_name=this.resonator_name,s.policy=this.policy,s.base_attr=this.base_attr,this.echoes.forEach((e,t)=>{s.echoes[t]=e.duplicate()}),s.summary=this.summary.duplicate(),s}getId(){let s="";return this.echoes.forEach(e=>{s=`${s}${e.getId()}`}),s}getJson(){return JSON.parse(JSON.stringify(this))}getRowBuffs(){return this.summary.getRowBuffs()}getPassiveSkillRowBuff(s,e,t,a,_){const r=new B;return r.category=k.ECHO,r.source=s,r.type=e,r.value=_,r.stack="1",r.element=t,r.skill_bonus_type=a,r.updateId(),r}getPassiveSkillRowBuffs(){const s=[],e=this.summary.name1;if(!e)return s;const t=`${e}-${M.MAIN_SLOT}`;switch(e){case g.HECATE:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.COORDINATED_ATTACK,"0.4"));break;case g.SENTRY_CONSTRUCT:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.GLACIO,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.SKILL,"0.12"));break;case g.LORELEI:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.HAVOC,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.BASIC,"0.12"));break;case g.NIGHTMARE_INFERNO_RIDER:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.FUSION,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.SKILL,"0.12"));break;case g.NIGHTMARE_THUNDERING_MEPHIS:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.ELECTRO,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.LIBERATION,"0.12"));break;case g.NIGHTMARE_TEMPEST_MEPHIS:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.ELECTRO,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.SKILL,"0.12"));break;case g.DRAGON_OF_DIRGE:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.FUSION,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.BASIC,"0.12"));break;case g.NIGHTMARE_CROWNLESS:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.HAVOC,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.BASIC,"0.12"));break;case g.NIGHTMARE_MOURNING_AIX:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.SPECTRO,"","0.12"));break;case g.NIGHTMARE_IMPERMANENCE_HERON:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.HAVOC,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.HEAVY,"0.12"));break;case g.NIGHTMARE_FEILIAN_BERINGAL:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.AERO,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.HEAVY,"0.12"));break;case g.CAPITANEUS:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.SPECTRO,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.HEAVY,"0.12"));break;case g.LIONESS_OF_GLORY:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.FUSION,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.LIBERATION,"0.12"));break;case g.REMINISCENCE_FLEURDELYS:switch(this.resonator_name){case es.RESONATOR_AERO:case es.CARTETHYIA:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.AERO,"","0.1"));break}s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.AERO,"","0.1"));break;case g.REMINISCENCE_FENRICO:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,c.HEAVY,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.AERO,"","0.12"));break;case g.NIGHTMARES_KELPIE:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.GLACIO,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.AERO,"","0.12"));break;case g.NIGHTMARES_HECATE:s.push(this.getPassiveSkillRowBuff(t,n.BONUS,o.HAVOC,"","0.12")),s.push(this.getPassiveSkillRowBuff(t,n.BONUS,"",c.ECHO,"0.2"));break;default:return s}return s}getSonatas(){if(this.summary.sonatas.length>0)return this.summary.sonatas;const s=[];return this.echoes.forEach(e=>{s.push(e.sonata)}),s}getSonataRowBuff(s,e,t,a,_){const r=new B;return r.category=k.SONATA,r.source=`${s}-2/2`,r.type=e,r.value=_,r.stack="1",r.element=t,r.skill_bonus_type=a,r.updateId(),r}getSonataRowBuffs(){const s=[],e={[f.FREEZING_FROST]:0,[f.MOLTEN_RIFT]:0,[f.VOID_THUNDER]:0,[f.SIERRA_GALE]:0,[f.CELESTIAL_LIGHT]:0,[f.SUN_SINKING_ECLIPSE]:0,[f.REJUVENATING_GLOW]:0,[f.MOONLIT_CLOUDS]:0,[f.LINGERING_TUNES]:0,[f.FROSTY_RESOLVE]:0,[f.ETERNAL_RADIANCE]:0,[f.MIDNIGHT_VEIL]:0,[f.EMPYREAN_ANTHEM]:0,[f.TIDEBREAKING_COURAGE]:0};if(this.echoes.forEach(t=>{const a=t.sonata;a&&(e[a]+=1)}),e[f.FREEZING_FROST]>=2){const t=this.getSonataRowBuff(f.FREEZING_FROST,n.BONUS,o.GLACIO,"","0.1");s.push(t)}if(e[f.MOLTEN_RIFT]>=2){const t=this.getSonataRowBuff(f.MOLTEN_RIFT,n.BONUS,o.FUSION,"","0.1");s.push(t)}if(e[f.VOID_THUNDER]>=2){const t=this.getSonataRowBuff(f.VOID_THUNDER,n.BONUS,o.ELECTRO,"","0.1");s.push(t)}if(e[f.SIERRA_GALE]>=2){const t=this.getSonataRowBuff(f.SIERRA_GALE,n.BONUS,o.AERO,"","0.1");s.push(t)}if(e[f.CELESTIAL_LIGHT]>=2){const t=this.getSonataRowBuff(f.CELESTIAL_LIGHT,n.BONUS,o.SPECTRO,"","0.1");s.push(t)}if(e[f.SUN_SINKING_ECLIPSE]>=2){const t=this.getSonataRowBuff(f.SUN_SINKING_ECLIPSE,n.BONUS,o.HAVOC,"","0.1");s.push(t)}if(e[f.REJUVENATING_GLOW]>=2){const t=this.getSonataRowBuff(f.REJUVENATING_GLOW,n.BONUS,"",c.HEALING,"0.1");s.push(t)}if(e[f.MOONLIT_CLOUDS]>=2){const t=this.getSonataRowBuff(f.MOONLIT_CLOUDS,n.ENERGY_REGEN,"","","0.1");s.push(t)}if(e[f.LINGERING_TUNES]>=2){const t=this.getSonataRowBuff(f.LINGERING_TUNES,n.ATK_P,"","","0.1");s.push(t)}if(e[f.FROSTY_RESOLVE]>=2){const t=this.getSonataRowBuff(f.FROSTY_RESOLVE,n.BONUS,"",c.SKILL,"0.12");s.push(t)}if(e[f.ETERNAL_RADIANCE]>=2){const t=this.getSonataRowBuff(f.ETERNAL_RADIANCE,n.BONUS,o.SPECTRO,"","0.1");s.push(t)}if(e[f.MIDNIGHT_VEIL]>=2){const t=this.getSonataRowBuff(f.MIDNIGHT_VEIL,n.BONUS,o.HAVOC,"","0.1");s.push(t)}if(e[f.EMPYREAN_ANTHEM]>=2){const t=this.getSonataRowBuff(f.EMPYREAN_ANTHEM,n.ENERGY_REGEN,"","","0.1");s.push(t)}if(e[f.TIDEBREAKING_COURAGE]>=2){const t=this.getSonataRowBuff(f.TIDEBREAKING_COURAGE,n.ENERGY_REGEN,"","","0.1");s.push(t)}return s}getEchoPolicyItems(){return[{title:$.global.t(`general.${O.AFFIXES_15_1}`),value:O.AFFIXES_15_1},{title:$.global.t(`general.${O.AFFIXES_20_SMALL}`),value:O.AFFIXES_20_SMALL},{title:$.global.t(`general.${O.AFFIXES_20_SKILL_BONUS}`),value:O.AFFIXES_20_SKILL_BONUS}]}resetPolicy(){this.policy=""}resetSummary(){this.summary.name1="",this.summary.sonatas=[],this.summary.total_cost=0,this.summary.main_affix=new m,this.summary.sub_affix=new m,this.summary.stat_bonus=new m}getEcho(s){return this.echoes[s]}updateEchoByCost(s,e){this.resetPolicy(),this.getEcho(s).updateByCost(e)}updateEchoByEchoItem(s,e){this.resetPolicy(),this.getEcho(s).updateByEchoItem(e)}updateEchoMainAffix(s,e){this.resetPolicy(),this.getEcho(s).updateMainAffix(e)}updateSummaryByEchoes(){this.resetSummary();const s=this.echoes[0].name;s&&(this.summary.name1=s),this.echoes.forEach(t=>{this.summary.total_cost+=parseFloat(t.cost);const a=t.sonata;a&&this.summary.sonatas.push(a),this.summary.main_affix.addStatBuff(t.main_affix),this.summary.sub_affix.addStatBuff(t.sub_affix)}),[...this.getPassiveSkillRowBuffs(),...this.getSonataRowBuffs()].forEach(t=>{const a=t.type,_=L(t.stack).times(L(t.value));let r;switch(a){case n.BONUS:switch(t.element){case o.GLACIO:r=R.BONUS_GLACIO;break;case o.FUSION:r=R.BONUS_FUSION;break;case o.ELECTRO:r=R.BONUS_ELECTRO;break;case o.AERO:r=R.BONUS_AERO;break;case o.SPECTRO:r=R.BONUS_SPECTRO;break;case o.HAVOC:r=R.BONUS_HAVOC;break}switch(t.skill_bonus_type){case c.BASIC:r=R.BONUS_BASIC_ATTACK;break;case c.HEAVY:r=R.BONUS_HEAVY_ATTACK;break;case c.SKILL:r=R.BONUS_RESONANCE_SKILL;break;case c.LIBERATION:r=R.BONUS_RESONANCE_LIBERATION;break;case c.HEALING:r=R.BONUS_HEALING;break}break;case n.ENERGY_REGEN:r=R.ENERGY_REGEN;break}r&&this.summary.stat_bonus.addByKey(r,_)})}}var as,ns,rs,os,_s,fs,us,ls,hs,cs,ms,ps,Es,ds;ds=l.SKILL_DMG_ADDITION,Es=l.MAGNIFIER,ps=l.AMPLIFIER,ms=l.BONUS,cs=l.HP_P,hs=l.HP,ls=l.ATK_P,us=l.ATK,fs=l.DEF_P,_s=l.DEF,os=l.CRIT_RATE,rs=l.CRIT_DMG,ns=l.IGNORE_DEF,as=l.REDUCE_RES;class ts{constructor(s={}){i(this,ds,"");i(this,Es,"");i(this,ps,"");i(this,ms,"");i(this,cs,"");i(this,hs,"");i(this,ls,"");i(this,us,"");i(this,fs,"");i(this,_s,"");i(this,os,"");i(this,rs,"");i(this,ns,"");i(this,as,"");!s||Object.keys(s).length===0||Object.assign(this,s)}reset(){this[l.SKILL_DMG_ADDITION]="",this[l.MAGNIFIER]="",this[l.AMPLIFIER]="",this[l.BONUS]="",this[l.HP_P]="",this[l.HP]="",this[l.ATK_P]="",this[l.ATK]="",this[l.DEF_P]="",this[l.DEF]="",this[l.CRIT_RATE]="",this[l.CRIT_DMG]="",this[l.IGNORE_DEF]="",this[l.REDUCE_RES]=""}getKeys(){const s=[];return Object.values(l).forEach(e=>{const t=this[e];E(t)>0&&s.push(e)}),s}getRowBuffs(){const s=[];return this.getKeys().forEach(t=>{const a=n[t.toUpperCase()],_=E(this[t]).toString(),r=new B;r.category=k.MANUAL,r.source=k.MANUAL,r.type=a,r.value=_,r.stack="1",r.updateId(),s.push(r)}),s}}class Y{constructor(s={}){i(this,"buffs",[]);i(this,"manual",new ts);if(!s||Object.keys(s).length===0)return;const{manual:e,...t}=s;Object.assign(this,t),this.manual=new ts(e)}getJson(){return JSON.parse(JSON.stringify(this))}getRowBuffs(){return[...this.buffs,...this.manual.getRowBuffs()]}}const Ls=[{name:"90等抗性10白板",level:"90",def:"1512",res_physics:"10.00%",res_glacio:"10.00%",res_fusion:"10.00%",res_electro:"10.00%",res_aero:"10.00%",res_spectro:"10.00%",res_havoc:"10.00%"},{name:"90等抗性20白板",level:"90",def:"1512",res_physics:"20.00%",res_glacio:"20.00%",res_fusion:"20.00%",res_electro:"20.00%",res_aero:"20.00%",res_spectro:"20.00%",res_havoc:"20.00%"},{name:"90等抗性30白板",level:"90",def:"1512",res_physics:"30.00%",res_glacio:"30.00%",res_fusion:"30.00%",res_electro:"30.00%",res_aero:"30.00%",res_spectro:"30.00%",res_havoc:"30.00%"},{name:"90等抗性40白板",level:"90",def:"1512",res_physics:"40.00%",res_glacio:"40.00%",res_fusion:"40.00%",res_electro:"40.00%",res_aero:"40.00%",res_spectro:"40.00%",res_havoc:"40.00%"},{name:"90等抗性50白板",level:"90",def:"1512",res_physics:"50.00%",res_glacio:"50.00%",res_fusion:"50.00%",res_electro:"50.00%",res_aero:"50.00%",res_spectro:"50.00%",res_havoc:"50.00%"},{name:"90等抗性60白板",level:"90",def:"1512",res_physics:"60.00%",res_glacio:"60.00%",res_fusion:"60.00%",res_electro:"60.00%",res_aero:"60.00%",res_spectro:"60.00%",res_havoc:"60.00%"},{name:"90等抗性70白板",level:"90",def:"1512",res_physics:"70.00%",res_glacio:"70.00%",res_fusion:"70.00%",res_electro:"70.00%",res_aero:"70.00%",res_spectro:"70.00%",res_havoc:"70.00%"},{name:"90等抗性80白板",level:"90",def:"1512",res_physics:"80.00%",res_glacio:"80.00%",res_fusion:"80.00%",res_electro:"80.00%",res_aero:"80.00%",res_spectro:"80.00%",res_havoc:"80.00%"},{name:"100等抗性10白板",level:"100",def:"1592",res_physics:"10.00%",res_glacio:"10.00%",res_fusion:"10.00%",res_electro:"10.00%",res_aero:"10.00%",res_spectro:"10.00%",res_havoc:"10.00%"},{name:"100等抗性20白板",level:"100",def:"1592",res_physics:"20.00%",res_glacio:"20.00%",res_fusion:"20.00%",res_electro:"20.00%",res_aero:"20.00%",res_spectro:"20.00%",res_havoc:"20.00%"},{name:"100等抗性30白板",level:"100",def:"1592",res_physics:"30.00%",res_glacio:"30.00%",res_fusion:"30.00%",res_electro:"30.00%",res_aero:"30.00%",res_spectro:"30.00%",res_havoc:"30.00%"},{name:"100等抗性40白板",level:"100",def:"1592",res_physics:"40.00%",res_glacio:"40.00%",res_fusion:"40.00%",res_electro:"40.00%",res_aero:"40.00%",res_spectro:"40.00%",res_havoc:"40.00%"},{name:"100等抗性50白板",level:"100",def:"1592",res_physics:"50.00%",res_glacio:"50.00%",res_fusion:"50.00%",res_electro:"50.00%",res_aero:"50.00%",res_spectro:"50.00%",res_havoc:"50.00%"},{name:"100等抗性60白板",level:"100",def:"1592",res_physics:"60.00%",res_glacio:"60.00%",res_fusion:"60.00%",res_electro:"60.00%",res_aero:"60.00%",res_spectro:"60.00%",res_havoc:"60.00%"},{name:"100等抗性70白板",level:"100",def:"1592",res_physics:"70.00%",res_glacio:"70.00%",res_fusion:"70.00%",res_electro:"70.00%",res_aero:"70.00%",res_spectro:"70.00%",res_havoc:"70.00%"},{name:"100等抗性80白板",level:"100",def:"1592",res_physics:"80.00%",res_glacio:"80.00%",res_fusion:"80.00%",res_electro:"80.00%",res_aero:"80.00%",res_spectro:"80.00%",res_havoc:"80.00%"}],is=Ls,Cs=xs("monster",{state:()=>({}),actions:{getMonsterItems(){return is.map((s,e,t)=>({title:s.name,value:s}))},getMonsterItemByName(b){for(const s of is)if(s.name===b)return{title:s.name,value:s}}}});class j{constructor(s={}){i(this,"name","");i(this,"level","");i(this,"def","");i(this,"res_physics","");i(this,"res_glacio","");i(this,"res_fusion","");i(this,"res_electro","");i(this,"res_aero","");i(this,"res_spectro","");i(this,"res_havoc","");i(this,"_item",{title:"",value:void 0});!s||Object.keys(s).length===0||Object.assign(this,s)}getJson(){return JSON.parse(JSON.stringify(this))}updateByMonsterItem(s){if(!s)return;const e=s;this.name=e.name,this.level=e.level,this.def=e.def,this.res_physics=e.res_physics,this.res_glacio=e.res_glacio,this.res_fusion=e.res_fusion,this.res_electro=e.res_electro,this.res_aero=e.res_aero,this.res_spectro=e.res_spectro,this.res_havoc=e.res_havoc}updateByName(s){const t=Cs().getMonsterItemByName(s);t&&this.updateByMonsterItem(t.value)}}class Ms{constructor(s={}){i(this,"resonator",new G);i(this,"weapon",new U);i(this,"echoes",new P);i(this,"buffs",new Y);i(this,"monster",new j);if(!s||Object.keys(s).length===0)return;const{resonator:e,weapon:t,echoes:a,buffs:_,monster:r}=s;this.resonator=new G(e),this.weapon=new U(t),this.echoes=new P(a),!this.echoes.resonator_name&&this.resonator.name&&(this.echoes.resonator_name=this.resonator.name),this.buffs=new Y(_),this.monster=new j(r)}}class Gs{constructor(){i(this,"base_attr",[]);i(this,"base_attr_p",[]);i(this,"base_attr_a",[]);i(this,"skill_dmg_addition",[]);i(this,"magnifier",[]);i(this,"amplifier",[]);i(this,"bonus",[]);i(this,"crit_rate",[]);i(this,"crit_dmg",[]);i(this,"ignore_def",[]);i(this,"reduce_res",[])}reset(){this.base_attr=[],this.base_attr_p=[],this.base_attr_a=[],this.skill_dmg_addition=[],this.magnifier=[],this.amplifier=[],this.bonus=[],this.crit_rate=[],this.crit_dmg=[],this.ignore_def=[],this.reduce_res=[]}}class Us{constructor(){i(this,"labels",[]);i(this,"resonator_name","");i(this,"skill_id","");i(this,"resonator_level","");i(this,"resonator_skill_level","");i(this,"resonator_skill_element","");i(this,"resonator_skill_base_attr","");i(this,"resonator_skill_type","");i(this,"resonator_skill_type_bonus","");i(this,"resonator_skill_dmg","");i(this,"resonator_skill_dmg_addition","");i(this,"echo_element","");i(this,"echo_skill_base_attr","");i(this,"echo_skill_dmg","");i(this,"damage_no_crit","");i(this,"damage_crit","");i(this,"damage","");i(this,"result_element","");i(this,"result_bonus_type","");i(this,"result_bonus_types",[]);i(this,"result_skill_base_attribute","");i(this,"result_skill_dmg","");i(this,"result_skill_hit","1");i(this,"result_hp","");i(this,"result_hp_addition","");i(this,"result_hp_p","");i(this,"result_atk","");i(this,"result_atk_addition","");i(this,"result_atk_p","");i(this,"result_def","");i(this,"result_def_addition","");i(this,"result_def_p","");i(this,"result_crit_rate","");i(this,"result_crit_dmg","");i(this,"result_magnifier","");i(this,"result_amplifier","");i(this,"result_bonus","");i(this,"result_ignore_def","");i(this,"result_reduce_res","");i(this,"monster_level","");i(this,"monster_def","");i(this,"monster_res","");i(this,"hits","");i(this,"real_dmg_no_crit","");i(this,"real_dmg_crit","");i(this,"action","");i(this,"time_start","");i(this,"time_end","");i(this,"buffs",[])}}class Js{constructor(s=new G,e=new U,t=new P,a=new Y,_=new j){i(this,"id","");i(this,"data",new Ms);i(this,"regions",new Gs);i(this,"result",new Us);this.data.resonator=s,this.data.weapon=e,this.data.echoes=t,!this.data.echoes.resonator_name&&this.data.resonator.name&&(this.data.echoes.resonator_name=this.data.resonator.name),this.data.buffs=a,this.data.monster=_}reset(){this.regions.reset()}getBaseRowBuffs(){const s=[],e=new B;e.category=k.BASE,e.source=k.BASE,e.type=n.CRIT_RATE,e.value="0.05",e.stack="1",e.updateId(),s.push(e);const t=new B;return t.category=k.BASE,t.source=k.BASE,t.type=n.CRIT_DMG,t.value="1.5",t.stack="1",t.updateId(),s.push(t),s}getRowBuffs(){this.data.echoes.updateSummaryByEchoes();let s=this.data.resonator.getBaseAttrs(),e=[];this.data.resonator.skill.base_attr===h.ATK&&(e=this.data.weapon.getBaseAttrs());const t=this.getBaseRowBuffs(),a=this.getMonsterResRowBuffs(),_=this.data.resonator.getRowBuffs(),r=this.data.resonator.getSkillRowBuffs(),S=this.data.weapon.getRowBuffs(),N=this.data.echoes.getRowBuffs(),A=this.data.echoes.getSonataRowBuffs(),I=this.data.echoes.getPassiveSkillRowBuffs(),w=this.data.buffs.getRowBuffs();return[...t,...a,...s,...e,..._,...r,...S,...N,...A,...I,...w]}getMonsterRes(){const s=this.data.resonator.skill.elment_zh_tw;let e;switch(s){case o.GLACIO:e=this.data.monster.res_glacio;break;case o.FUSION:e=this.data.monster.res_fusion;break;case o.ELECTRO:e=this.data.monster.res_electro;break;case o.AERO:e=this.data.monster.res_aero;break;case o.SPECTRO:e=this.data.monster.res_spectro;break;case o.HAVOC:e=this.data.monster.res_havoc;break;default:e="0.2";break}return E(e)}getFinalMonsterRes(){const s=this.regions.reduce_res;let e=new u(0);return s.forEach((t,a)=>{const _=new u(E(t.value)),r=new u(E(t.stack)),S=_.times(r);a===0?e=S:(e||(e=new u(E(e))),e=e.minus(S))}),e}getMonsterResRowBuffs(){const s=[],e=new B;return e.category=k.MONSTER,e.source=this.data.monster.name,e.type=n.REDUCE_RES,e.value=this.getMonsterRes().toString(),e.stack="1",e.element=this.data.resonator.skill.elment_zh_tw,e.updateId(),s.push(e),s}updateId(){this.id=Bs(JSON.stringify(this.data))}updateRegions(s){const e=this.data.resonator.skill.base_attr;s.forEach(t=>{switch(t.type){case W.ATTR:this.regions.base_attr.push(t);break;case n.SKILL_DMG_ADDITION:this.regions.skill_dmg_addition.push(t);break;case n.MAGNIFIER:this.regions.magnifier.push(t);break;case n.AMPLIFIER:this.regions.amplifier.push(t);break;case n.BONUS:if(!t.element&&!t.skill_bonus_type){this.regions.bonus.push(t);break}if(t.element&&t.skill_bonus_type)throw new Error("`element` and `skill_bonus_type` should not have values at the same time.");if(this.data.resonator.skill.bonus_types.includes(t.element)||this.data.resonator.skill.bonus_types.includes(t.skill_bonus_type)){this.regions.bonus.push(t);break}break;case n.HP_P:e===h.HP&&this.regions.base_attr_p.push(t);break;case n.HP:e===h.HP&&this.regions.base_attr_a.push(t);break;case n.ATK_P:e===h.ATK&&this.regions.base_attr_p.push(t);break;case n.ATK:e===h.ATK&&this.regions.base_attr_a.push(t);break;case n.DEF_P:e===h.DEF&&this.regions.base_attr_p.push(t);break;case n.DEF:e===h.DEF&&this.regions.base_attr_a.push(t);break;case n.CRIT_RATE:this.regions.crit_rate.push(t);break;case n.CRIT_DMG:this.regions.crit_dmg.push(t);break;case n.IGNORE_DEF:this.regions.ignore_def.push(t);break;case n.REDUCE_RES:this.regions.reduce_res.push(t);break}})}sumRegion(s){let e=new u(0);return s.forEach(t=>{const a=new u(E(t.value)),_=new u(E(t.stack));e=e.plus(a.times(_))}),e}calculate(){this.updateId(),this.reset();const s=this.getRowBuffs();this.updateRegions(s);const e=this.sumRegion(this.regions.base_attr),t=this.sumRegion(this.regions.base_attr_p),a=this.sumRegion(this.regions.base_attr_a),_=e.times(t.plus(new u(1))).plus(a),r=this.sumRegion(this.regions.skill_dmg_addition),S=this.sumRegion(this.regions.magnifier),N=S.plus(new u(1)),A=this.sumRegion(this.regions.amplifier),I=A.plus(new u(1)),w=this.sumRegion(this.regions.bonus),gs=w.plus(new u(1)),z=this.sumRegion(this.regions.crit_dmg);let T=this.sumRegion(this.regions.crit_rate);T.gte(new u(1))&&(T=new u(1));const X=new u(E(this.data.resonator.level)),Z=new u(E(this.data.monster.level)).times(new u(8)).plus(new u(792)),q=this.sumRegion(this.regions.ignore_def),Ss=X.times(new u(8)).plus(new u(800)).dividedBy(X.times(new u(8)).plus(new u(800)).plus(Z.times(new u(1).minus(q)))),y=this.getFinalMonsterRes(),Rs=new u(this.getMonsterRes()).minus(y);let F;y.lt(new u(0))?F=new u(1).minus(y.dividedBy(new u(2))):y.gte(new u(.8))?F=new u(1).dividedBy(y.times(new u(5)).plus(new u(1))):F=new u(1).minus(y);const ks=new u(this.data.resonator.skill.hit),V=_.times(r).times(N).times(I).times(gs).times(Ss).times(F).times(ks),Q=V.times(z),As=Q.times(T).plus(new u(1).minus(T).times(V));if(this.result.resonator_name=this.data.resonator.name,this.result.skill_id=this.data.resonator.skill.id,this.result.resonator_level=this.data.resonator.level,this.result.resonator_skill_level=this.data.resonator.skill.level,this.result.resonator_skill_element=this.data.resonator.skill.elment_zh_tw,this.result.resonator_skill_base_attr=this.data.resonator.skill.base_attr,this.result.resonator_skill_type=this.data.resonator.skill.type,this.result.resonator_skill_dmg=this.data.resonator.skill.dmg,this.regions.skill_dmg_addition.length>1){let Is=this.sumRegion(this.regions.skill_dmg_addition.slice(1));this.result.resonator_skill_dmg_addition=Is.toString()}switch(this.result.damage=p(As),this.result.damage_crit=p(Q),this.result.damage_no_crit=p(V),this.result.result_element=this.data.resonator.skill.elment_zh_tw,this.result.result_bonus_types=this.data.resonator.skill.bonus_types,this.result.result_skill_base_attribute=this.data.resonator.skill.base_attr,this.result.result_skill_dmg=this.data.resonator.skill.dmg,this.result.result_skill_hit=this.data.resonator.skill.hit,this.data.resonator.skill.base_attr){case h.HP:this.result.result_hp=p(e),this.result.result_hp_addition=p(a),this.result.result_hp_p=p(t);break;case h.DEF:this.result.result_def=p(e),this.result.result_def_addition=p(a),this.result.result_def_p=p(t);break;case h.ATK:default:this.result.result_atk=p(e),this.result.result_atk_addition=p(a),this.result.result_atk_p=p(t);break}this.result.result_crit_rate=p(T),this.result.result_crit_dmg=p(z),this.result.result_magnifier=p(S),this.result.result_amplifier=p(A),this.result.result_bonus=p(w),this.result.result_ignore_def=p(q),this.result.result_reduce_res=p(Rs),this.result.monster_level=this.data.monster.level,this.result.monster_def=p(Z),this.result.monster_res=p(this.getMonsterRes()),this.result.hits=this.data.resonator.skill.hit,this.result.action}}class Ps{constructor(s,e,t){i(this,"resonator");i(this,"weapon");i(this,"echoes");if(this.resonator=s,this.weapon=e,this.echoes=t,!this.echoes.resonator_name&&this.resonator.name&&(this.echoes.resonator_name=this.resonator.name),t.echoes.length!==5)throw new Error("`echoStores` length must be exactly 5")}getBaseAbbr(){const s=this.echoes.base_attr;let e;switch(s){case h.HP:e=d.HP;break;case h.DEF:e=d.DEF;break;case h.ATK:default:e=d.ATK;break}return e}getCritAttr(){const s=parseFloat(this.weapon.stat_bonus.crit_rate),e=parseFloat(this.weapon.stat_bonus.crit_dmg);return!s&&e?d.CRIT_RATE:s&&!e?d.CRIT_DMG:d.CRIT_DMG}updateSubAffixesWithAffixes151(s){switch(this.echoes.base_attr){case h.HP:s.sub_affix.hp="270",s.sub_affix.hp_p="0.054";break;case h.DEF:s.sub_affix.def="30",s.sub_affix.def_p="0.068325";break;case h.ATK:default:s.sub_affix.atk="24",s.sub_affix.atk_p="0.054";break}s.sub_affix.crit_rate="0.084",s.sub_affix.crit_dmg="0.1008",s.sub_affix.bonus_resonance_skill="0.016",s.sub_affix.bonus_basic_attack="0.016",s.sub_affix.bonus_heavy_attack="0.016",s.sub_affix.bonus_resonance_liberation="0.016"}updateSubAffixesWithAffixes20Small(s){switch(this.echoes.base_attr){case h.HP:s.sub_affix.hp="450",s.sub_affix.hp_p="0.09";break;case h.DEF:s.sub_affix.def="50",s.sub_affix.def_p="0.113875";break;case h.ATK:default:s.sub_affix.atk="40",s.sub_affix.atk_p="0.09";break}s.sub_affix.crit_rate="0.084",s.sub_affix.crit_dmg="0.168"}updateSubAffixesWithAffixes20SkillBonus(s){switch(this.echoes.base_attr){case h.HP:s.sub_affix.hp_p="0.09";break;case h.DEF:s.sub_affix.def_p="0.113875";break;case h.ATK:default:s.sub_affix.atk_p="0.09";break}switch(s.sub_affix.crit_rate="0.084",s.sub_affix.crit_dmg="0.168",this.echoes.main_skill_bonus){case c.SKILL:s.sub_affix.bonus_resonance_skill="0.09";break;case c.BASIC:s.sub_affix.bonus_basic_attack="0.09";break;case c.HEAVY:s.sub_affix.bonus_heavy_attack="0.09";break;case c.LIBERATION:s.sub_affix.bonus_resonance_liberation="0.09";break}}updateBase(){this.echoes.echoes.forEach((s,e)=>{switch(s.resetMainAffix(),s.resetSubAffix(),this.echoes.policy){case O.AFFIXES_15_1:this.updateSubAffixesWithAffixes151(s);break;case O.AFFIXES_20_SMALL:this.updateSubAffixesWithAffixes20Small(s);break;case O.AFFIXES_20_SKILL_BONUS:this.updateSubAffixesWithAffixes20SkillBonus(s);break}})}updateFixedMainAffix(s,e){const t=bs(e);for(const[a,_]of Object.entries(t))s.main_affix[a]=_,s._fixed_main_affix_key=a}updateMainAffixItem(s,e){s._main_affix_item={title:J(e),value:e}}updateCost4Echo(s,e){const t="4";s.cost=t,s.abbr=e,s.updateMainAffixKeysByCost(),this.updateFixedMainAffix(s,t);const a=C(t);switch(e){case d.HP:s.main_affix.hp_p=a.hp_p,this.updateMainAffixItem(s,"hp_p");break;case d.ATK:s.main_affix.atk_p=a.atk_p,this.updateMainAffixItem(s,"atk_p");break;case d.DEF:s.main_affix.def_p=a.def_p,this.updateMainAffixItem(s,"def_p");break;case d.BONUS_HEALING:s.main_affix.bonus_healing=a.bonus_healing,this.updateMainAffixItem(s,"bonus_healing");break;case d.CRIT_RATE:s.main_affix.crit_rate=a.crit_rate,this.updateMainAffixItem(s,"crit_rate");break;case d.CRIT_DMG:default:s.main_affix.crit_dmg=a.crit_dmg,this.updateMainAffixItem(s,"crit_dmg");break}}updateCost3Echo(s,e){const t="3";s.cost=t,s.abbr=e,s.updateMainAffixKeysByCost(),this.updateFixedMainAffix(s,t);const a=C(t);switch(e){case d.HP:s.main_affix.hp_p=a.hp_p,this.updateMainAffixItem(s,"hp_p");break;case d.ATK:s.main_affix.atk_p=a.atk_p,this.updateMainAffixItem(s,"atk_p");break;case d.DEF:s.main_affix.def_p=a.def_p,this.updateMainAffixItem(s,"def_p");break;case d.ENERGY_REGEN:s.main_affix.energy_regen=a.energy_regen,this.updateMainAffixItem(s,"energy_regen");break;case o.GLACIO:s.main_affix.bonus_glacio=a.bonus_glacio,this.updateMainAffixItem(s,"bonus_glacio");break;case o.FUSION:s.main_affix.bonus_fusion=a.bonus_fusion,this.updateMainAffixItem(s,"bonus_fusion");break;case o.ELECTRO:s.main_affix.bonus_electro=a.bonus_electro,this.updateMainAffixItem(s,"bonus_electro");break;case o.AERO:s.main_affix.bonus_aero=a.bonus_aero,this.updateMainAffixItem(s,"bonus_aero");break;case o.SPECTRO:s.main_affix.bonus_spectro=a.bonus_spectro,this.updateMainAffixItem(s,"bonus_spectro");break;case o.HAVOC:s.main_affix.bonus_havoc=a.bonus_havoc,this.updateMainAffixItem(s,"bonus_havoc");break}}updateCost1Echo(s,e){const t="1";s.cost=t,s.abbr=e,s.updateMainAffixKeysByCost(),this.updateFixedMainAffix(s,t);const a=C(t);switch(e){case d.HP:s.main_affix.hp_p=a.hp_p,this.updateMainAffixItem(s,"hp_p");break;case d.ATK:s.main_affix.atk_p=a.atk_p,this.updateMainAffixItem(s,"atk_p");break;case d.DEF:s.main_affix.def_p=a.def_p,this.updateMainAffixItem(s,"def_p");break}}updateEcho(s,e,t){switch(e=e.toString(),e){case"4":t||(t=this.getCritAttr()),this.updateCost4Echo(this.echoes.echoes[s],t);break;case"3":t||(t=this.resonator.element_zh_tw),this.updateCost3Echo(this.echoes.echoes[s],t);break;case"1":t||(t=this.getBaseAbbr()),this.updateCost1Echo(this.echoes.echoes[s],t);break;default:return}}update(s,e,t,a,_,r,S,N,A,I){!this.echoes.policy||this.echoes.echoes.length===0||(this.updateBase(),this.updateEcho(0,s,r),this.updateEcho(1,e,S),this.updateEcho(2,t,N),this.updateEcho(3,a,A),this.updateEcho(4,_,I))}update43311(s="",e="",t="",a="",_=""){this.update("4","3","3","1","1",s,e,t,a,_)}update43311With2Elem(){this.echoes.base_attr,this.resonator.element_zh_tw}update43311With1Elem1Attr(){this.resonator.element_zh_tw}update43311With2Attr(){}update43311With2EnergyRegen(){}update43311With1EnergyRegen1Elem(){this.resonator.element_zh_tw}update43311With1EnergyRegen1Attr(){}}function Ys(b,s,e){new Ps(b,s,e).update43311()}export{Y as R,j as a,P as b,U as c,G as d,Ys as e,Ps as f,Js as g,Ms as h,Cs as u};
