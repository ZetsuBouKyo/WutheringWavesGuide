import{V as ue,_ as Ve}from"./VCombobox-oNRwgfHX.js";import{g as ge,p as be,ak as we,al as ye,am as me,j as P,an as se,a8 as d,ad as fe,b as ke,ao as Ce,a as o,F as ee,a5 as le,ap as he,aq as _e,ar as $e,d as Ne,ac as Ie,Z as Se,N as $,o as N,O as n,a9 as j,Q as T,a1 as b,ag as V,ah as m,a2 as p,n as Re,a4 as ie,M as Be}from"./index-C7j9b9qh.js";import{_ as xe}from"./Rotation-DvGkfN2V.js";import{u as Ae}from"./resonator-C8vTBfod.js";import{g as Fe,a as Ue}from"./rotation-BW8Ohv5F.js";import{s as Pe}from"./utils-CKOygh4Q.js";import{V as L,a as ze}from"./VTextarea-CZyWmqh0.js";import{V as Q}from"./VCard-Beadeszt.js";import{u as De,a as re,f as je,b as Ee,c as Oe,d as Te,m as Je,e as Me,g as te,V as qe,h as de}from"./VDataTable-Bn5rSf9u.js";import{b as ce}from"./route-block-B_A1xBdJ.js";import"./VList-B5-klKDD.js";import"./VAvatar-Cf_z-VoW.js";import"./VTooltip-DIUmh7r8.js";import"./VOverlay-CL9re2XM.js";const Le=be({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:a=>typeof a=="boolean"||[1e3,1024].includes(Number(a))},...Me({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:a=>a.multiple?[]:null,validator:a=>me(a).every(w=>w!=null&&typeof w=="object")},...Je({clearable:!0})},"VFileInput"),Qe=ge()({name:"VFileInput",inheritAttrs:!1,props:Le(),emits:{"click:control":a=>!0,"mousedown:control":a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0},setup(a,w){let{attrs:ae,emit:y,slots:g}=w;const{t:J}=we(),s=ye(a,"modelValue",a.modelValue,u=>me(u),u=>!a.multiple&&Array.isArray(u)?u[0]:u),{isFocused:I,focus:z,blur:E}=De(a),k=P(()=>typeof a.showSize!="boolean"?a.showSize:void 0),S=P(()=>(s.value??[]).reduce((u,r)=>{let{size:F=0}=r;return u+F},0)),C=P(()=>se(S.value,k.value)),h=P(()=>(s.value??[]).map(u=>{const{name:r="",size:F=0}=u;return a.showSize?`${r} (${se(F,k.value)})`:r})),R=P(()=>{var r;const u=((r=s.value)==null?void 0:r.length)??0;return a.showSize?J(a.counterSizeString,u,C.value):J(a.counterString,u)}),B=d(),x=d(),f=d(),A=P(()=>I.value||a.active),M=P(()=>["plain","underlined"].includes(a.variant));function i(){var u;f.value!==document.activeElement&&((u=f.value)==null||u.focus()),I.value||z()}function O(u){var r;(r=f.value)==null||r.click()}function Z(u){y("mousedown:control",u)}function G(u){var r;(r=f.value)==null||r.click(),y("click:control",u)}function H(u){u.stopPropagation(),i(),_e(()=>{s.value=[],$e(a["onClick:clear"],u)})}return fe(s,u=>{(!Array.isArray(u)||!u.length)&&f.value&&(f.value.value="")}),ke(()=>{const u=!!(g.counter||a.counter),r=!!(u||g.details),[F,K]=Ce(ae),{modelValue:oe,...W}=re.filterProps(a),X=je(a);return o(re,le({ref:B,modelValue:s.value,"onUpdate:modelValue":U=>s.value=U,class:["v-file-input",{"v-file-input--chips":!!a.chips,"v-file-input--hide":a.hideInput,"v-input--plain-underlined":M.value},a.class],style:a.style,"onClick:prepend":O},F,W,{centerAffix:!M.value,focused:I.value}),{...g,default:U=>{let{id:D,isDisabled:l,isDirty:e,isReadonly:c,isValid:t}=U;return o(Oe,le({ref:x,"prepend-icon":a.prependIcon,onMousedown:Z,onClick:G,"onClick:clear":H,"onClick:prependInner":a["onClick:prependInner"],"onClick:appendInner":a["onClick:appendInner"]},X,{id:D.value,active:A.value||e.value,dirty:e.value||a.dirty,disabled:l.value,focused:I.value,error:t.value===!1}),{...g,default:v=>{var ne;let{props:{class:q,...Y}}=v;return o(ee,null,[o("input",le({ref:f,type:"file",readonly:c.value,disabled:l.value,multiple:a.multiple,name:a.name,onClick:_=>{_.stopPropagation(),c.value&&_.preventDefault(),i()},onChange:_=>{if(!_.target)return;const pe=_.target;s.value=[...pe.files??[]]},onFocus:i,onBlur:E},Y,K),null),o("div",{class:q},[!!((ne=s.value)!=null&&ne.length)&&!a.hideInput&&(g.selection?g.selection({fileNames:h.value,totalBytes:S.value,totalBytesReadable:C.value}):a.chips?h.value.map(_=>o(Te,{key:_,size:"small",text:_},null)):h.value.join(", "))])])}})},details:r?U=>{var D,l;return o(ee,null,[(D=g.details)==null?void 0:D.call(g,U),u&&o(ee,null,[o("span",null,null),o(Ee,{active:!!((l=s.value)!=null&&l.length),value:R.value,disabled:a.disabled},g.counter)])])}:void 0})}),he({},B,x,f)}}),Ze={class:"d-flex flex-column"},Ge={class:"d-flex flex-row ml-auto"},He={class:"d-flex flex-column"},Ke={class:"d-flex flex-row ml-auto"},We={class:"d-flex flex-column"},Xe={class:"d-flex flex-row ml-auto"},Ye={class:"d-flex flex-column"},el={class:"d-flex flex-row ml-auto"},ll={class:"container d-flex flex-column"},tl={class:"d-flex flex-row ml-auto mb-2"},ve=Ne({__name:"rotation_builder",setup(a){const{t:w}=Ie();let y=Se().query.spoiler;y==="true"||y===!0?y=!0:y=!1;const J=Ae().getNames(y),s=d(void 0),I=d([]),z=d(!1),E=d([]),k=d(!1),S=d(void 0),C=d(!1),h=d(void 0),R=d(!1),B=d(void 0),x=d(""),f=d(!1),A=d(void 0),M=[{title:w("general.row"),key:"id",width:"100px"},{title:w("general.resonator"),key:"resonator_name",width:"200px"},{title:w("general.action"),key:"action",width:"200px"},{title:"",key:"tools"}],i=d([{id:0,resonator_name:"",action:"",selected:!1,comment:""}]);function O(){i.value.forEach((l,e)=>{l.id=e})}function Z(){let l;z.value?l=!0:l=!1,i.value.forEach(e=>{e.selected=l}),s.value=void 0}function G(){let l=0;return i.value.forEach(e=>{e.selected&&(l+=1)}),l}function H(l){const e=l.selected;e&&(s.value=l.id),!e&&l.id===s.value&&(s.value=void 0),z.value=!1}function u(){const l=i.value[A.value];l.id===A.value&&(l.comment=x.value.toString(),f.value=!1,x.value="")}function r(l,e){const c=[];for(let v=0;v<e;v++)c.push({id:0,resonator_name:"",action:"",selected:!1,comment:""});const t=[...i.value.slice(0,l),...c,...i.value.slice(l)];i.value=t,O()}function F(){const l=Number(s.value);if(isNaN(l))return;const e=Number(S.value);isNaN(e)||(r(l,e),k.value=!1,S.value=void 0)}function K(){let l=Number(s.value);if(isNaN(l))return;const e=Number(h.value);isNaN(e)||(l+=1,r(l,e),C.value=!1,h.value=void 0)}function oe(){O();const l=i.value.length,e=l+Number(B.value);if(typeof e=="number"){for(let c=l;c<e;c++)i.value.push({id:c,resonator_name:"",action:"",selected:!1,comment:""});R.value=!1,B.value=void 0}}function W(){const l=[];i.value.forEach((e,c)=>{e.selected||l.push(e)}),i.value=l,O()}function X(){Pe(i.value)}const U=d("");function D(l){const e=l.target;if(!e.files||e.files.length===0)return;const c=e.files[0];U.value=c.name;const t=new FileReader;t.onload=v=>{var q;try{i.value=JSON.parse((q=v.target)==null?void 0:q.result)}catch(Y){console.error("Invalid JSON file",Y)}},t.readAsText(c)}return fe(()=>JSON.stringify(i.value),()=>{const l=[];i.value.forEach(e=>{e.resonator_name&&e.action&&l.push(e)}),l.length>0?E.value=Fe(l):l.length===0&&(E.value=[])}),(l,e)=>{const c=Ve;return N(),$(c,null,{default:n(()=>[s.value!==void 0?(N(),$(L,{key:0,modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=t=>k.value=t),width:"auto"},{default:n(()=>[o(Q,{"min-width":"400",title:l.$t("general.insert_above_at_n",{n:s.value+1})},{default:n(()=>[o(T,null,{default:n(()=>[b("div",Ze,[o(te,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=t=>S.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),b("div",Ge,[o(V,{class:"mr-2",onClick:e[1]||(e[1]=t=>k.value=!1)},{default:n(()=>[m(p(l.$t("general.cancel")),1)]),_:1}),o(V,{onClick:F},{default:n(()=>[m(p(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):j("",!0),s.value!==void 0?(N(),$(L,{key:1,modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=t=>C.value=t),width:"auto"},{default:n(()=>[o(Q,{"min-width":"400",title:l.$t("general.insert_below_at_n",{n:s.value+1})},{default:n(()=>[o(T,null,{default:n(()=>[b("div",He,[o(te,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=t=>h.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),b("div",Ke,[o(V,{class:"mr-2",onClick:e[4]||(e[4]=t=>C.value=!1)},{default:n(()=>[m(p(l.$t("general.cancel")),1)]),_:1}),o(V,{onClick:K},{default:n(()=>[m(p(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):j("",!0),o(L,{modelValue:R.value,"onUpdate:modelValue":e[8]||(e[8]=t=>R.value=t),width:"auto"},{default:n(()=>[o(Q,{"min-width":"400",title:l.$t("general.insert_bottom")},{default:n(()=>[o(T,null,{default:n(()=>[b("div",We,[o(te,{modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=t=>B.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),b("div",Xe,[o(V,{class:"mr-2",onClick:e[7]||(e[7]=t=>R.value=!1)},{default:n(()=>[m(p(l.$t("general.cancel")),1)]),_:1}),o(V,{onClick:oe},{default:n(()=>[m(p(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),A.value!==void 0?(N(),$(L,{key:2,modelValue:f.value,"onUpdate:modelValue":e[11]||(e[11]=t=>f.value=t),width:"auto"},{default:n(()=>[o(Q,{"min-width":"400",title:l.$t("general.nth_row_comment",{n:A.value+1})},{default:n(()=>[o(T,null,{default:n(()=>[b("div",Ye,[o(ze,{modelValue:x.value,"onUpdate:modelValue":e[9]||(e[9]=t=>x.value=t)},null,8,["modelValue"]),b("div",el,[o(V,{class:"mr-2",onClick:e[10]||(e[10]=t=>{f.value=!1})},{default:n(()=>[m(p(l.$t("general.cancel")),1)]),_:1}),o(V,{onClick:u},{default:n(()=>[m(p(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):j("",!0),o(T,{class:"mb-12"},{default:n(()=>[b("div",ll,[b("div",tl,[o(Qe,{"max-width":"200","min-width":"200",label:l.$t("general.load_file"),class:"mr-2",accept:".json",variant:"outlined",density:"compact",onChange:D},null,8,["label"]),G()>0?(N(),$(V,{key:0,class:"mr-2",onClick:e[12]||(e[12]=t=>{s.value=void 0})},{default:n(()=>[m(p(l.$t("general.delete")),1)]),_:1})):j("",!0),s.value!==void 0?(N(),$(V,{key:1,class:"mr-2",onClick:e[13]||(e[13]=t=>k.value=!0)},{default:n(()=>[m(p(l.$t("general.insert_above")),1)]),_:1})):j("",!0),s.value!==void 0?(N(),$(V,{key:2,class:"mr-2",onClick:e[14]||(e[14]=t=>C.value=!0)},{default:n(()=>[m(p(l.$t("general.insert_below")),1)]),_:1})):j("",!0),o(V,{class:"mr-2",onClick:e[15]||(e[15]=t=>R.value=!0)},{default:n(()=>[m(p(l.$t("general.insert_bottom")),1)]),_:1}),o(V,{onClick:X},{default:n(()=>[m(p(l.$t("general.download_json")),1)]),_:1})]),o(qe,{class:"table mb-2",headers:M,items:i.value,"items-per-page":i.value.length,"show-select":"",selected:I.value,"onUpdate:selected":e[18]||(e[18]=t=>I.value=t),"disable-sort":"","hide-default-footer":""},{"item.id":n(({item:t})=>[m(p(l.$t("general.nth_row",{n:t.id+1})),1)]),"header.data-table-select":n(()=>[o(de,{modelValue:z.value,"onUpdate:modelValue":[e[16]||(e[16]=t=>z.value=t),e[17]||(e[17]=t=>Z())],color:"primary"},null,8,["modelValue"])]),"item.data-table-select":n(({item:t})=>[o(de,{modelValue:t.selected,"onUpdate:modelValue":[v=>t.selected=v,v=>H(t)]},null,8,["modelValue","onUpdate:modelValue"])]),"item.resonator_name":n(({item:t})=>[o(ue,{modelValue:t.resonator_name,"onUpdate:modelValue":v=>t.resonator_name=v,items:ie(J),variant:"outlined",width:"180px",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),"item.action":n(({item:t})=>[o(ue,{modelValue:t.action,"onUpdate:modelValue":v=>t.action=v,items:ie(Ue)(),variant:"outlined",width:"180px",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),"item.tools":n(({item:t})=>[o(Re,{class:"me-2",size:"small",onClick:v=>{f.value=!0,A.value=t.id}},{default:n(()=>e[19]||(e[19]=[m(" mdi-pencil ")])),_:2},1032,["onClick"])]),_:1},8,["items","items-per-page","selected"]),(N(),$(xe,{rotation:E.value,key:JSON.stringify(i.value)},null,8,["rotation"]))])]),_:1})]),_:1})}}});typeof ce=="function"&&ce(ve);const gl=Be(ve,[["__scopeId","data-v-4d8e0a89"]]);export{gl as default};
