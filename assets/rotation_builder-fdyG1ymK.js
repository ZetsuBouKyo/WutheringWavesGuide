import{V as ae,a as O,_ as oe}from"./VFileInput-myhq3fuS.js";import{d as ne,ac as se,Z as ue,a8 as s,ad as ie,N as c,o as p,O as a,a9 as V,a as o,Q as N,a1 as v,ag as d,ah as u,a2 as i,n as re,a4 as j,M as de}from"./index-_rGMOtXQ.js";import{_ as me}from"./Rotation-BjxXxhYQ.js";import{u as fe}from"./resonator-L2IJcEFW.js";import{g as ve,a as ce}from"./rotation-BJ4FdInY.js";import{s as pe}from"./utils-CVNhfOQy.js";import{V as B,a as Ve}from"./VTextarea-B3-kMuMx.js";import{V as R}from"./VCard-DL3OjWra.js";import{a as A,V as ge,b as F}from"./VDataTable-X5i49bN0.js";import{b as q}from"./route-block-B_A1xBdJ.js";import"./VList-B59MJPtI.js";import"./VAvatar-BB87pnRB.js";import"./VTooltip-D7pmX43y.js";import"./VOverlay-BSUdevTx.js";const we={class:"d-flex flex-column"},be={class:"d-flex flex-row ml-auto"},_e={class:"d-flex flex-column"},$e={class:"d-flex flex-row ml-auto"},ke={class:"d-flex flex-column"},Ne={class:"d-flex flex-row ml-auto"},Ce={class:"d-flex flex-column"},ye={class:"d-flex flex-row ml-auto"},he={class:"container d-flex flex-column"},xe={class:"d-flex flex-row ml-auto mb-2"},z=ne({__name:"rotation_builder",setup(Ue){const{t:S}=se();let g=ue().query.spoiler;g==="true"||g===!0?g=!0:g=!1;const M=fe().getNames(g),r=s(void 0),E=s([]),C=s(!1),D=s([]),w=s(!1),y=s(void 0),b=s(!1),h=s(void 0),_=s(!1),x=s(void 0),U=s(""),$=s(!1),k=s(void 0),Q=[{title:S("general.row"),key:"id",width:"100px"},{title:S("general.resonator"),key:"resonator_name",width:"200px"},{title:S("general.action"),key:"action",width:"200px"},{title:"",key:"tools"}],n=s([{id:0,resonator_name:"",action:"",selected:!1,comment:""}]);function I(){n.value.forEach((l,e)=>{l.id=e})}function Z(){let l;C.value?l=!0:l=!1,n.value.forEach(e=>{e.selected=l}),r.value=void 0}function G(){let l=0;return n.value.forEach(e=>{e.selected&&(l+=1)}),l}function H(l){const e=l.selected;e&&(r.value=l.id),!e&&l.id===r.value&&(r.value=void 0),C.value=!1}function K(){const l=n.value[k.value];l.id===k.value&&(l.comment=U.value.toString(),$.value=!1,U.value="")}function J(l,e){const m=[];for(let f=0;f<e;f++)m.push({id:0,resonator_name:"",action:"",selected:!1,comment:""});const t=[...n.value.slice(0,l),...m,...n.value.slice(l)];n.value=t,I()}function L(){const l=Number(r.value);if(isNaN(l))return;const e=Number(y.value);isNaN(e)||(J(l,e),w.value=!1,y.value=void 0)}function P(){let l=Number(r.value);if(isNaN(l))return;const e=Number(h.value);isNaN(e)||(l+=1,J(l,e),b.value=!1,h.value=void 0)}function W(){I();const l=n.value.length,e=l+Number(x.value);if(typeof e=="number"){for(let m=l;m<e;m++)n.value.push({id:m,resonator_name:"",action:"",selected:!1,comment:""});_.value=!1,x.value=void 0}}function X(){const l=[];n.value.forEach((e,m)=>{e.selected||l.push(e)}),n.value=l,I()}function Y(){pe(n.value)}const ee=s("");function le(l){const e=l.target;if(!e.files||e.files.length===0)return;const m=e.files[0];ee.value=m.name;const t=new FileReader;t.onload=f=>{var T;try{n.value=JSON.parse((T=f.target)==null?void 0:T.result)}catch(te){console.error("Invalid JSON file",te)}},t.readAsText(m)}return ie(()=>JSON.stringify(n.value),()=>{const l=[];n.value.forEach(e=>{e.resonator_name&&e.action&&l.push(e)}),l.length>0?D.value=ve(l):l.length===0&&(D.value=[])}),(l,e)=>{const m=oe;return p(),c(m,null,{default:a(()=>[r.value!==void 0?(p(),c(B,{key:0,modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),width:"auto"},{default:a(()=>[o(R,{"min-width":"400",title:l.$t("general.insert_above_at_n",{n:r.value+1})},{default:a(()=>[o(N,null,{default:a(()=>[v("div",we,[o(A,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),v("div",be,[o(d,{class:"mr-2",onClick:e[1]||(e[1]=t=>w.value=!1)},{default:a(()=>[u(i(l.$t("general.cancel")),1)]),_:1}),o(d,{onClick:L},{default:a(()=>[u(i(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):V("",!0),r.value!==void 0?(p(),c(B,{key:1,modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=t=>b.value=t),width:"auto"},{default:a(()=>[o(R,{"min-width":"400",title:l.$t("general.insert_below_at_n",{n:r.value+1})},{default:a(()=>[o(N,null,{default:a(()=>[v("div",_e,[o(A,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=t=>h.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),v("div",$e,[o(d,{class:"mr-2",onClick:e[4]||(e[4]=t=>b.value=!1)},{default:a(()=>[u(i(l.$t("general.cancel")),1)]),_:1}),o(d,{onClick:P},{default:a(()=>[u(i(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):V("",!0),o(B,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=t=>_.value=t),width:"auto"},{default:a(()=>[o(R,{"min-width":"400",title:l.$t("general.insert_bottom")},{default:a(()=>[o(N,null,{default:a(()=>[v("div",ke,[o(A,{modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=t=>x.value=t),label:l.$t("general.row"),placeholder:"0"},null,8,["modelValue","label"]),v("div",Ne,[o(d,{class:"mr-2",onClick:e[7]||(e[7]=t=>_.value=!1)},{default:a(()=>[u(i(l.$t("general.cancel")),1)]),_:1}),o(d,{onClick:W},{default:a(()=>[u(i(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),k.value!==void 0?(p(),c(B,{key:2,modelValue:$.value,"onUpdate:modelValue":e[11]||(e[11]=t=>$.value=t),width:"auto"},{default:a(()=>[o(R,{"min-width":"400",title:l.$t("general.nth_row_comment",{n:k.value+1})},{default:a(()=>[o(N,null,{default:a(()=>[v("div",Ce,[o(Ve,{modelValue:U.value,"onUpdate:modelValue":e[9]||(e[9]=t=>U.value=t)},null,8,["modelValue"]),v("div",ye,[o(d,{class:"mr-2",onClick:e[10]||(e[10]=t=>{$.value=!1})},{default:a(()=>[u(i(l.$t("general.cancel")),1)]),_:1}),o(d,{onClick:K},{default:a(()=>[u(i(l.$t("general.confirm")),1)]),_:1})])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):V("",!0),o(N,{class:"mb-12"},{default:a(()=>[v("div",he,[v("div",xe,[o(ae,{"max-width":"200","min-width":"200",label:l.$t("general.load_file"),class:"mr-2",accept:".json",variant:"outlined",density:"compact",onChange:le},null,8,["label"]),G()>0?(p(),c(d,{key:0,class:"mr-2",onClick:e[12]||(e[12]=t=>{r.value=void 0})},{default:a(()=>[u(i(l.$t("general.delete")),1)]),_:1})):V("",!0),r.value!==void 0?(p(),c(d,{key:1,class:"mr-2",onClick:e[13]||(e[13]=t=>w.value=!0)},{default:a(()=>[u(i(l.$t("general.insert_above")),1)]),_:1})):V("",!0),r.value!==void 0?(p(),c(d,{key:2,class:"mr-2",onClick:e[14]||(e[14]=t=>b.value=!0)},{default:a(()=>[u(i(l.$t("general.insert_below")),1)]),_:1})):V("",!0),o(d,{class:"mr-2",onClick:e[15]||(e[15]=t=>_.value=!0)},{default:a(()=>[u(i(l.$t("general.insert_bottom")),1)]),_:1}),o(d,{onClick:Y},{default:a(()=>[u(i(l.$t("general.download_json")),1)]),_:1})]),o(ge,{class:"table mb-2",headers:Q,items:n.value,"items-per-page":n.value.length,"show-select":"",selected:E.value,"onUpdate:selected":e[18]||(e[18]=t=>E.value=t),"disable-sort":"","hide-default-footer":""},{"item.id":a(({item:t})=>[u(i(l.$t("general.nth_row",{n:t.id+1})),1)]),"header.data-table-select":a(()=>[o(F,{modelValue:C.value,"onUpdate:modelValue":[e[16]||(e[16]=t=>C.value=t),e[17]||(e[17]=t=>Z())],color:"primary"},null,8,["modelValue"])]),"item.data-table-select":a(({item:t})=>[o(F,{modelValue:t.selected,"onUpdate:modelValue":[f=>t.selected=f,f=>H(t)]},null,8,["modelValue","onUpdate:modelValue"])]),"item.resonator_name":a(({item:t})=>[o(O,{modelValue:t.resonator_name,"onUpdate:modelValue":f=>t.resonator_name=f,items:j(M),variant:"outlined",width:"180px",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),"item.action":a(({item:t})=>[o(O,{modelValue:t.action,"onUpdate:modelValue":f=>t.action=f,items:j(ce)(),variant:"outlined",width:"180px",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),"item.tools":a(({item:t})=>[o(re,{class:"me-2",size:"small",onClick:f=>{$.value=!0,k.value=t.id}},{default:a(()=>e[19]||(e[19]=[u(" mdi-pencil ")])),_:2},1032,["onClick"])]),_:1},8,["items","items-per-page","selected"]),(p(),c(me,{rotation:D.value,key:JSON.stringify(n.value)},null,8,["rotation"]))])]),_:1})]),_:1})}}});typeof q=="function"&&q(z);const Ze=de(z,[["__scopeId","data-v-4d8e0a89"]]);export{Ze as default};
